<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Berlin Store - Order Status & Products</title>
    <link rel="icon" type="image/png" href="./images/BerlinStore.png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* === START: أنيميشن نافذة تفاصيل الدفع === */

        /* 1. تعريف حركة الصعود والظهور */
        @keyframes payment-details-slide-up {
            from {
                opacity: 0;
                transform: translateY(15px); /* تبدأ من أسفل قليلاً */
            }

            to {
                opacity: 1;
                transform: translateY(0); /* تنتهي في مكانها الطبيعي */
            }
        }

        /* 2. تطبيق الحركة على قسم الدفع عند ظهوره */
        #vodafoneDetails.is-visible,
        #paypalDetails.is-visible {
            animation: payment-details-slide-up 0.4s ease-out;
        }

        /* === END: أنيميشن نافذة تفاصيل الدفع === */
        /* تنسيق المجموعة الجديدة لحقول الإدخال */
        .form-inputs-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* تنسيق الحاوية الجديدة التي تجمع حقول الإدخال والزر */
        .payment-details-grid {
            display: grid;
            /* هذا يضع حقول الإدخال على اليمين والزر على اليسار */
            grid-template-areas:
                "button inputs"
                "button inputs";
            gap: 10px;
        }

        /* تنسيق حقول الإدخال لتمتلئ في مكانها */
        .input-fields {
            grid-area: inputs;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* تنسيق زر "تم الدفع!" ليكون في مكانه الصحيح */
        .button-container {
            grid-area: button;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* لرفعه للأعلى */
        }

        .confirm-payment-btn {
            width: 150%; /* لجعل الزر يملأ الحاوية بالكامل */
        }

        .payment-layout {
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* يمكن حذف هذا السطر أو تركه */
            align-items: flex-start; /* هذا هو السطر الجديد لرفع المحتوى للأعلى */
            gap: 30px;
            margin-top: 20px;
            flex-direction: row-reverse; /* هذا السطر هو الإضافة الجديدة */
        }

/* تنسيق حاوية الـ QR code */
.qr-code-container {
    text-align: center;
    padding: 15px;
    background-color: rgb(93, 0, 18, 0.05);
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    /* السطرين التاليين يدفعان الحاوية إلى اليسار */
    margin-left: 0;
    margin-right: auto;
}

.qr-code-container p {
    font-size: 14px;
    color: var(--light-text);
    margin-bottom: 10px;
}

/* تنسيق صورة الـ QR code */
.qr-code-image {
    width: 150px; /* حجم مناسب لرمز الـ QR */
    height: auto;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

/* تحسينات للشاشات الصغيرة */
@media (max-width: 600px) {
    .payment-info-box {
        flex-direction: column;
        align-items: center;
        text-align: center;
    }
}
        /* === START: Roblox Section Background === */
        #roblox {
            /* -->> غير هذا المسار إلى مسار صورة روبلوكس الصحيح <<-- */
            background-image: linear-gradient(rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.65)), url('./images/Robloxwallpaper.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            border-radius: 15px;
            padding: 20px;
        }
        /* === END: Roblox Section Background === */
        #valorantPoints {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('./images/Ascent_Map.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            border-radius: 15px;
            padding: 20px;
        }

        /* === START: Store Reviews Carousel === */
.reviews-carousel-container {
    max-width: 90%; /* تقدر تغير العرض حسب ما يناسبك */
    margin: 20px auto;
    overflow: hidden; /* أهم جزء: لإخفاء باقي التقييمات اللي بره الإطار */
    position: relative;
    -webkit-mask-image: linear-gradient(to right, transparent, black 20%, black 80%, transparent 100%);
    mask-image: linear-gradient(to right, transparent, black 20%, black 80%, transparent 100%);
}

.reviews-carousel-track {
    display: flex; /* عشان يخلي الكروت جنب بعض */
    gap: 20px; /* مسافة بين كل تقييم والتاني */
    /* العرض ده بيتحسب بناءً على عدد الكروت وعرض كل كارت (هنضاعفهم بالجافاسكريبت) */
    /* مثال: لو عندك 10 كروت وعرض الكارت 270px، العرض هيكون (270 * 20) = 5400px */
    width: calc(270px * 20); 
    animation: scroll 40s linear infinite; /* اسم الأنيميشن ومدته ونوعه */
}

/* الأنيميشن اللي بيحرك الشريط من اليمين للشمال */
@keyframes scroll {
    0% {
        transform: translateX(0);
    }
    100% {
        /* بنحركه بنسبة 50% عشان لما يخلص يرجع للبداية من غير ما يبان فرق */
        transform: translateX(calc(-270px * 10)); 
    }
}

/* عشان نوقف الحركة لما الماوس يجي فوق التقييمات */
.reviews-carousel-container:hover .reviews-carousel-track {
    animation-play-state: paused;
}

/* تعديل بسيط على كارت التقييم عشان يناسب الحركة */
#store-reviews-list .comment-card {
    flex: 0 0 250px; /* بنثبت عرض الكارت عشان ميتمطش */
    height: auto;
    margin-bottom: 0; /* مش محتاجين مسافة سفلية هنا */
}
/* === END: Store Reviews Carousel === */
        /* === START: Store Average Rating Styles === */
        #store-average-rating-display {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background-color: rgba(0,0,0,0.2);
            border-radius: 12px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

            #store-average-rating-display .stars {
                font-size: 2.5rem; /* حجم كبير للنجوم */
                color: var(--accent-yellow);
                margin-bottom: 10px;
            }

                #store-average-rating-display .stars .star.empty {
                    color: #555; /* لون النجمة الفارغة */
                }

            #store-average-rating-display .summary-text {
                font-size: 1rem;
                color: var(--light-text);
                font-weight: bold;
            }
        /* === END: Store Average Rating Styles === */
        .payment-info-label {
            color: var(--green-buy-btn); /* استخدام متغير اللون الأخضر من تصميمك */
            font-weight: bold;
        }
        .green-text {
            color: #28a745; /* هذا لون أخضر شائع وجذاب */
        }
        .modal .product-modal-image {
            max-width: 150px;
            height: auto;
        }
        /* تنسيق صورة المنتج داخل النافذة المنبثقة */
        .modal-content img.product-modal-image {
            max-width: 150px; /* أقصى عرض للصورة */
            height: auto; /* يحافظ على نسبة أبعاد الصورة */
            margin-bottom: 15px; /* مسافة أسفل الصورة */
            border-radius: 8px; /* حواف دائرية للصورة */
        }
        /* === START: كود تغيير لون الوصف في نافذة الشراء === */
        #modalProductInfo .description-display {
            color: var(--accent-yellow); /* استخدام نفس متغير اللون الأصفر للموقع */
            font-weight: bold; /* لجعل الخط أثقل وأوضح */
            font-size: 15px; /* تكبير الخط قليلاً ليكون مناسبًا */
        }
        /* === END: كود تغيير لون الوصف في نافذة الشراء === */

        #fortnite {
            position: relative;
            z-index: 1;
            overflow: hidden; /* لإخفاء أي أجزاء زائدة من الخلفية عند الحواف الدائرية */
        }

            #fortnite::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
            }
        /* === START: Subscription Options Style === */
        #subscription-options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .subscription-option-label {
            position: relative;
            cursor: pointer;
        }

            .subscription-option-label input[type="radio"] {
                appearance: none; /* إخفاء زر الراديو الأصلي */
                -webkit-appearance: none;
                position: absolute;
            }

        .subscription-option-card {
            background-color: var(--main-purple);
            border: 2px solid #8e6abf;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: bold;
        }

            .subscription-option-card .period {
                display: block;
                font-size: 16px;
                color: var(--white-text);
            }

            .subscription-option-card .price {
                display: block;
                font-size: 14px;
                color: var(--accent-yellow);
                margin-top: 5px;
            }

        .subscription-option-label:hover .subscription-option-card {
            transform: translateY(-3px);
            border-color: var(--accent-yellow);
        }

        /* هذا هو أهم جزء، يغير شكل الزر عند اختياره */
        .subscription-option-label input[type="radio"]:checked + .subscription-option-card {
            background-color: rgba(255, 204, 0, 0.2);
            border-color: var(--accent-yellow);
            box-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
        }
        /* === END: Subscription Options Style === */
        .cart-item-extra-info {
            font-size: 12px;
            color: #ccc;
            margin-top: 4px;
            direction: ltr;
            text-align: right;
        }
        :root {
            --dark-bg: #1e1132;
            --main-purple: #2c1a40;
            --accent-yellow: #ffcc00;
            --light-text: #e0e0e0;
            --card-bg: rgba(74, 47, 100, 0.5);
            --dark-card-bg: rgba(74, 47, 100, 0.7);
            --white-text: white;
            --black-text: #110e1a;
            --green-buy-btn: #28a745;
            --green-buy-btn-hover: #218838;
            --fixed-cart-bg: #28a745;
        }

        body {
            font-family: 'Tajawal', 'Cairo', sans-serif;
            margin: 0;
            background: linear-gradient(135deg, var(--dark-bg), #1a0e2a);
            background-attachment: fixed;
            color: var(--light-text);
            direction: rtl;
            text-align: right;
            padding-top: 70px;
            padding-bottom: 70px;
        }

        #home {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('./images/wallpaper.png');
            background-size: 100% auto;
            background-repeat: no-repeat;
            background-position: top center;
            position: relative;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid white;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin: 20px;
        }

            .glass-card.darker {
                background: var(--main-purple);
                border: 1px solid #8e6abf;
                backdrop-filter: none;
            }
        #steam-gift-cards-section {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('./images/steamwallpaper.png');
            background-size: cover;
            background-position: center;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(6px);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

            #steam-gift-cards-section:hover {
                transform: scale(1.02);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            }

        /* الكود ده خاص بصفحة "Steam Gift Cards" الكاملة */
        #steamGiftCards {
            background-image: url('./images/steamwallpaper.png');
            background-size: cover;
            background-position: center;
            position: relative;
            z-index: 1;
        }
        #navbar {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            background-color: var(--main-purple);
            padding: 4px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 2000;
            transition: background-color 0.3s ease, backdrop-filter 0.3s ease;
        }

            #navbar.navbar-scrolled {
                background-color: rgba(44, 26, 64, 0.8);
                backdrop-filter: blur(18px);
                -webkit-backdrop-filter: blur(2px);
            }

            #navbar .logo-area {
                display: flex;
                align-items: center;
                margin-left: auto;
            }

                #navbar .logo-area img {
                    width: 80px;
                    height: auto;
                    margin-left: 10px;
                }

            #navbar .logo-text-container {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                line-height: 1.1;
            }

        .by-sohayl {
            font-size: 18px;
            font-weight: bold;
            color: var(--accent-yellow);
            text-shadow: 0 0 8px rgba(255, 204, 0, 0.8);
            margin-bottom: 1px;
        }

            .by-sohayl a {
                color: var(--accent-yellow);
                text-decoration: none;
                transition: color 0.3s ease;
            }

                .by-sohayl a:hover {
                    color: #e6b800;
                }

        .country-name {
            font-size: 13px;
            font-weight: bold;
            color: var(--white-text);
            text-shadow: none;
            display: flex;
            align-items: center;
        }

            .country-name .flag-emoji {
                margin-left: 5px;
                font-size: 18px;
            }

        #navbar .nav-link {
            margin-left: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: color 0.3s ease;
            font-size: 14px;
            position: relative;
            padding-bottom: 5px;
            color: var(--light-text);
            text-decoration: none;
        }

            #navbar .nav-link::after {
                content: '';
                position: absolute;
                width: 100%;
                height: 2px;
                bottom: 0;
                left: 0;
                background-color: var(--accent-yellow);
                transform: scaleX(0);
                transform-origin: right;
                transition: transform 0.3s ease-out;
            }

            #navbar .nav-link:hover::after {
                transform: scaleX(1);
                transform-origin: left;
            }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: var(--main-purple);
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            right: 0;
            top: 100%;
            border-radius: 8px;
            overflow: hidden;
            text-align: right;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

            .dropdown-content a {
                color: var(--light-text);
                padding: 12px 16px;
                text-decoration: none;
                display: block;
                font-weight: bold;
            }

                .dropdown-content a:hover {
                    background-color: rgba(255, 255, 255, 0.1);
                    color: var(--accent-yellow);
                }

        .dropdown:hover .dropdown-content {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        #navbar .logo-area,
        #navbar .logo-area .country-name {
            cursor: default;
        }

        #navbar .nav-link:hover {
            color: var(--accent-yellow);
        }

        .support-button {
            margin-left: 15px;
            font-size: 14px;
            cursor: pointer;
            font-weight: bold;
            color: var(--white-text);
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
            margin-right: auto;
        }

            .support-button img {
                margin-left: 5px;
            }

            .support-button:hover {
                color: var(--accent-yellow);
            }

        .support-icon {
            width: 20px;
            height: auto;
        }

        .fixed-cart-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background-color: var(--fixed-cart-bg);
            color: var(--white-text);
            border: 2px solid var(--accent-yellow);
            border-radius: 50px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            font-weight: bold;
        }

            .fixed-cart-button:hover {
                background-color: var(--green-buy-btn-hover);
                color: var(--white-text);
                transform: scale(1.05);
            }

        @keyframes pop {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.15);
            }

            100% {
                transform: scale(1);
            }
        }

        .fixed-cart-button.added {
            animation: pop 0.4s ease-in-out;
        }

        .fixed-cart-button img {
            width: 24px;
            height: auto;
        }

        .fixed-cart-button .cart-count {
            background-color: red;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 12px;
            position: absolute;
            top: -5px;
            right: -5px;
        }

        h1, h2, h3 {
            margin-right: 20px;
            border-right: 4px solid var(--accent-yellow);
            padding-right: 10px;
            display: inline-block;
        }

        h3 {
            margin-right: 0;
            border-right: none;
            padding-right: 0;
            display: inline-block;
        }

        input, select, textarea {
            padding: 12px;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid white;
            margin-top: 10px;
            width: 300px;
            font-family: 'Tajawal', sans-serif;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--white-text);
            transition: border-color 0.3s ease;
        }

            input::placeholder,
            textarea::placeholder {
                color: var(--light-text);
                opacity: 0.8;
            }

            input:focus, select:focus, textarea:focus {
                outline: none;
                border-color: #e6b800;
            }

        select {
            background-color: var(--main-purple);
            color: var(--white-text);
        }

            select option {
                background-color: var(--main-purple);
                color: var(--white-text);
            }

        button {
            padding: 12px 20px;
            font-size: 16px;
            margin-top: 15px;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            background-color: var(--accent-yellow);
            color: var(--black-text);
            transition: transform 0.3s ease, background-color 0.3s ease;
            font-family: 'Cairo', sans-serif;
        }

            button:hover {
                background-color: #e6b800;
                transform: translateY(-2px);
            }

        .payment-confirm-btn {
            background-color: var(--green-buy-btn);
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            transition: background-color 0.3s ease, transform 0.3s ease;
            font-family: 'Cairo', sans-serif;
        }

        .payment-details-form {
                flex: 1;
                min-width: 250px;
                display: flex;
                flex-direction: row; /* تم تغيير هذا السطر من column إلى row */
                flex-wrap: wrap-reverse; /* هذا السطر الجديد سيضع الزر على اليسار */
                align-items: flex-start;
                gap: 10px;
        }

            .payment-details-form input,
            .payment-details-form textarea {
                flex-grow: 1; /* لجعل حقول الإدخال تملأ المساحة المتاحة */
                width: auto; /* لضمان أن الحقول تأخذ عرضها الطبيعي */
            }

        .confirm-payment-btn {
            width: 200px; /* يمكنك تغيير هذه القيمة لتغيير عرض الزر */
            margin: 20px 0 0 0; /* هامش من الأعلى فقط */
            margin-left: 0; /* هذا السطر يدفعه إلى اليسار */
        }

        .confirm-payment-btn {
            /* الآن يمكننا التحكم في موقعه داخل النموذج */
            width: 100%; /* لجعل الزر يملأ عرض النموذج */
            margin: 0;
            margin-top: auto; /* هذا السطر يدفعه إلى الأسفل */
        }

        button:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }

        .payment-confirm-btn:hover:not(:disabled) {
            background-color: var(--green-buy-btn-hover);
            transform: translateY(-3px);
        }

        #shipping {
            text-align: center;
            display: none;
            padding: 20px;
            animation: fadeIn 0.8s ease-in-out;
        }

        #orderInputContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

            #orderInputContainer label {
                font-size: 24px;
                font-weight: bold;
                color: var(--light-text);
                margin-bottom: 10px;
            }

        #shippingDescription {
            font-size: 14px;
            color: #ccc;
            margin-top: -15px;
            margin-bottom: 20px;
        }

        #statusContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: var(--main-purple);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            margin: 0 auto;
        }

        #statusImage {
            width: 400px;
            height: auto;
            margin-top: 15px;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        #resultText {
            font-size: 24px;
            font-weight: bold;
            margin-top: 10px;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        #products {
            padding-top: 5px;
        }

        .search-bar-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
            margin-bottom: 20px;
            margin-right: 0;
            margin-left: 0;
        }

        #productSearch {
            width: 250px;
            margin-left: 10px;
            padding: 10px;
        }

        .products-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .product-item {
            background: linear-gradient(145deg, rgba(74, 47, 100, 0.6), rgba(31, 17, 51, 0.8));
            padding: 10px;
            border-radius: 12px;
            width: 180px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            border: 1px solid #8e6abf;
        }

            .product-item:hover {
                transform: translateY(-8px);
                box-shadow: 0 10px 25px rgba(74, 47, 100, 0.5);
                animation: shake 0.5s ease-in-out;
            }

            .product-item.valorant-item {
                width: 145px;
            }

        .product-image-wrapper {
            width: 100%;
            height: 160px;
            border-radius: 8px;
            background-color: rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        @keyframes placeholder-shine {
            0% {
                background-position: -100% 0;
            }

            100% {
                background-position: 100% 0;
            }
        }

        .product-image-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.1) 50%, transparent 100%);
            animation: placeholder-shine 1.5s infinite linear;
        }

        .product-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            background-color: transparent;
            position: relative;
            z-index: 2;
        }

        .product-item h3 {
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0;
            border-right: none;
            padding-right: 0;
            margin-top: 10px;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .platform-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
            padding: 4px;
        }

            .platform-icon img {
                width: 100%;
                height: 100%;
            }

        .platform-icon-description {
            height: 16px;
            vertical-align: middle;
            margin-right: 4px;
        }

        .product-description-text {
            font-size: 14px;
            color: var(--accent-yellow);
            margin-top: -5px;
            margin-bottom: 5px;
            padding: 0 5px;
        }


        /* New style for urgency message */
        .product-urgency {
            color: #ff4757;
            font-weight: bold;
            margin-top: 5px;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .product-item p {
            min-height: 24px;
            margin-top: 2px;
            margin-bottom: 5px;
        }

        .subscription-item {
            background: linear-gradient(145deg, rgba(74, 47, 100, 0.6), rgba(31, 17, 51, 0.8));
            border-radius: 12px;
            width: 320px;
            display: flex;
            flex-direction: column;
            padding: 0;
            overflow: hidden;
            border: 1px solid var(--main-purple);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

            .subscription-item:hover {
                transform: translateY(-8px);
                box-shadow: 0 10px 25px rgba(74, 47, 100, 0.5);
            }

            .subscription-item .sub-image-wrapper {
                width: 100%;
                height: 150px;
                overflow: hidden;
                cursor: pointer;
                position: relative;
            }

        .sub-description-overlay {
            position: absolute;
            top: 8px;
            left: 8px;
            z-index: 3;
            background: rgba(0,0,0,0.6);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            max-width: 80%;
            text-align: left;
            direction: ltr;
        }

        .subscription-item .sub-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .subscription-item:hover .sub-image-wrapper img {
            transform: scale(1.1);
        }

        .subscription-item .sub-content {
            padding: 20px;
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

            .subscription-item .sub-content h3 {
                font-size: 1.25rem;
                margin: 0 0 10px 0;
                padding: 0;
                border: none;
                color: var(--white-text);
                text-align: center;
                display: block;
                cursor: pointer;
            }

            .subscription-item .sub-content p.sub-description {
                font-size: 0.9rem;
                color: var(--light-text);
                margin: 0 0 15px 0;
                flex-grow: 1;
                min-height: 50px;
                text-align: center;
            }

        .subscription-item .sub-footer {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-top: auto;
            padding-top: 15px;
        }

        .subscription-item .sub-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-yellow);
        }

        .subscription-item .subscribe-btn {
            padding: 10px 20px;
            font-size: 16px;
            margin-top: 0;
            font-weight: bold;
            background-color: var(--green-buy-btn);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

            .subscription-item .subscribe-btn img {
                width: 20px;
                height: 20px;
            }

            .subscription-item .subscribe-btn:hover {
                background-color: var(--green-buy-btn-hover);
            }

        .section {
            display: none;
            padding: 20px;
            animation: fadeIn 0.8s ease-in-out;
        }

        .content-page {
            max-width: 800px;
            margin: 20px auto;
            padding: 30px;
            line-height: 1.8;
        }

            .content-page h2 {
                text-align: center;
                border: none;
            }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shake {
            0% {
                transform: rotate(0deg) translateY(-8px);
            }

            25% {
                transform: rotate(2deg) translateY(-8px);
            }

            50% {
                transform: rotate(0deg) translateY(-8px);
            }

            75% {
                transform: rotate(-2deg) translateY(-8px);
            }

            100% {
                transform: rotate(0deg) translateY(-8px);
            }
        }

        .product-image {
            display: block;
            width: 80%;
            max-width: 400px;
            height: auto;
            border-radius: 12px;
            margin: 0 auto 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .modal .product-image {
            max-width: 250px;
            margin: 0 auto 10px;
        }

        .modal.valorant-modal .product-image {
            max-width: 180px;
        }

        .modal.fortnite-modal .product-image {
            max-width: 180px;
        }

        .product-description-box {
            border: 1px solid white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            background-color: rgba(255, 255, 255, 0.05);
        }

        #productPageDescription {
            font-size: 16px;
            text-align: right;
            margin-top: 10px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        #productDescription strong {
            color: var(--accent-yellow);
        }

        .product-description .steam-logo,
        .product-description .microsoft-logo,
        .product-description .netflix-logo,
        .product-description .disney-logo,
        .payment-logo {
            vertical-align: middle;
            height: 20px;
            margin-right: 5px;
        }

        .payment-option-logo {
            height: 18px;
            width: auto;
            vertical-align: middle;
            margin-left: 8px;
        }

        .payment-logo {
            vertical-align: middle;
            height: 25px;
        }

        #loading {
            display: none;
            margin-top: 15px;
            font-size: 18px;
            font-weight: bold;
            color: var(--accent-yellow);
        }

        #confirmationMessage {
            margin-top: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #00ff00;
            text-align: center;
        }

        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-yellow);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

/* تنسيقات عامة للنافذة المنبثقة */
.modal {
    position: fixed;
    z-index: 2000;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    width: 90%;
    max-width: 650px; /* تم زيادة العرض ليتسع للمحتوى */
    padding: 25px;
    max-height: 90vh;
    display: none; /* إخفاء النافذة افتراضياً */
    flex-direction: column;
    background: rgba(30, 17, 50, 0.8);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.modal.is-visible {
    display: flex; /* لجعله يظهر عند الاستدعاء */
    opacity: 1;
    pointer-events: auto;
    transform: translate(-50%, -50%) scale(1);
}
        /* === START: أنيميشن فتح النافذة المنبثقة === */

        /* 1. تعريف الحركة نفسها */
        @keyframes modal-fade-in {
            from {
                opacity: 0;
                transform: translate(-50%, -45%) scale(0.98); /* تبدأ من أعلى قليلاً وبحجم أصغر */
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1); /* تنتهي في مكانها الطبيعي */
            }
        }

        /* 2. تطبيق الحركة على النافذة عند ظهورها */
        .modal.is-visible {
            animation: modal-fade-in 0.1s ease-out;
        }

        /* === END: أنيميشن فتح النافذة المنبثقة === */

/* تنسيق الحاوية الرئيسية لنافذة الدفع */
#vodafoneDetails .payment-layout {
    display: flex;
    flex-wrap: wrap;
    align-items: flex-start;
    justify-content: flex-end; /* ليدفع المحتوى إلى اليمين */
    gap: 30px;
    margin-top: 20px;
}

/* تنسيق حاوية الـ QR code (لتكون على اليسار) */
#vodafoneDetails .payment-info-container {
    text-align: right;
    flex: 1;
    min-width: 250px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    /* هذا هو التعديل الأهم: لدفعه إلى اليسار في حالة وجود مساحة */
    order: 1; 
}

/* تنسيق نموذج الإدخال (ليكون على اليمين) */
#vodafoneDetails .payment-details-form {
    flex: 1;
    min-width: 250px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    /* هذا هو التعديل الأهم: لدفعه إلى اليمين في حالة وجود مساحة */
    order: 2; 
}

/* تنسيق زر "تم الدفع!" ليكون في أعلى اليسار */
        /* تنسيق زر "تم الدفع!" ليكون في أعلى اليسار */
        /* تنسيق زر "تم الدفع!" ليكون في أعلى اليمين */
        #vodafoneForm .confirm-payment-btn {
            width: auto;
            margin-top: 0;
            margin-left: auto;
            padding: 15px 30px;
            font-size: 18px;
            /* ... باقي الخصائص ... */
        }


            /* التحكم في حجم صورة المنتج داخل النافذة المنبثقة */
            .modal .product-image {
                max-width: 160px; /* يمكنك تعديل هذا الرقم لتصغير أو تكبير الصورة كما تريد */
                height: auto; /* للحفاظ على أبعاد الصورة الصحيحة */
                margin: 0 auto 15px; /* لتوسيط الصورة وإضافة مسافة أسفلها */
            }

        .modal.is-visible {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }
        /* === END: Final Modal Styles === */


            .modal.is-visible {
                opacity: 1;
                pointer-events: auto;
                transform: translate(-50%, -50%) scale(1);
            }

                .modal.is-visible.payment-modal .modal-body > div {
                    display: none;
                }

                .modal.is-visible.payment-modal .modal-body .payment-options-container.is-visible {
                    display: block;
                }

                .modal.is-visible.payment-modal .modal-body .payment-details.is-visible {
                    display: block;
                }

        .overlay {
            display: none;
            position: fixed;
            z-index: 1999;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            -webkit-backdrop-filter: blur(8px);
            backdrop-filter: blur(8px);
            animation: fadeInOverlay 0.3s ease-in-out;
        }

        @keyframes fadeInOverlay {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal .payment-details {
            margin-top: 20px;
            text-align: center;
        }

            .modal .payment-details p {
                margin-bottom: 10px;
                text-align: center;
            }

        .modal input, .modal textarea {
            width: 80%;
            max-width: 250px;
            display: block;
            margin-right: auto;
            margin-left: auto;
            text-align: right;
        }


        /* === START: Valorant Purchase Fix === */
        .form-parallel-group {
            display: flex;
            flex-wrap: wrap; /* Allows items to wrap on smaller screens */
            gap: 15px;
            margin: 20px auto;
            width: 95%;
            max-width: 400px;
        }

            .form-parallel-group > div {
                flex: 1; /* This makes the containers grow equally */
                min-width: 150px; /* A minimum width before wrapping */
            }

            .form-parallel-group label {
                display: block;
                margin-bottom: 8px;
                font-size: 14px;
                font-weight: bold;
                text-align: right;
                padding-right: 5px;
            }

            .form-parallel-group input,
            .form-parallel-group select {
                width: 100%; /* Makes the input/select fill its container */
                margin-top: 0;
                box-sizing: border-box;
            }


        /* === END: Valorant Purchase Fix === */
        .account-details-container {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

            .account-details-container input {
                width: 90%;
                max-width: 280px;
            }

        .modal button {
            margin-top: 20px;
        }

        .button-container {
            grid-area: button;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .modal .confirm-payment-btn, .buy-btn-product-page, .add-to-cart-text-btn, .checkout-btn-centered {
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 8px;
            font-weight: bold;
            transition: transform 0.3s ease, background-color 0.3s ease;
            font-family: 'Cairo', sans-serif;
            background-color: var(--green-buy-btn);
            color: white;
            border: 1px solid white;
        }

            .modal .confirm-payment-btn:hover, .buy-btn-product-page:hover, .add-to-cart-text-btn:hover, .checkout-btn-centered:hover {
                background-color: var(--green-buy-btn-hover);
                transform: translateY(-2px);
            }

        .modal .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            color: var(--white-text);
            cursor: pointer;
            transition: color 0.3s;
        }

            .modal .close-btn:hover {
                color: var(--accent-yellow);
            }

        .modal-body h2 {
            text-align: center;
            border-right: 0;
            margin-right: 0;
            display: block;
            width: 100%;
        }

        .modal-body h2, .modal-body p, .modal-body img {
            text-align: center;
            margin-right: auto;
            margin-left: auto;
        }

        .modal-product-info {
            text-align: center;
            font-size: 14px;
            color: #ccc;
            margin: -5px auto 10px;
            max-width: 90%;
        }

        /* === START: كود توسيط معلومات المنصة في النافذة المنبثقة === */
        #modalProductInfo .platform-display {
            display: flex;
            align-items: center;
            justify-content: center; /* لتوسيط كل شيء في النص */
            width: 100%;
            gap: 8px;
            margin-bottom: 10px; /* مسافة بسيطة للأسفل */
        }
        /* === END: كود توسيط معلومات المنصة في النافذة المنبثقة === */

                .modal-product-info .platform-display img {
                    height: 18px;
                    width: auto;
                }

            .modal-product-info .description-display {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
                text-overflow: ellipsis;
                line-height: 1.4;
            }

        #productPageContent {
            display: flex;
            flex-direction: column;
        }

        .product-main-view {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }

        .product-image-section {
            flex: 1.2;
            min-width: 300px;
        }

            .product-image-section .main-image {
                width: 100%;
                height: auto;
                border-radius: 12px;
                box-shadow: 0 6px 20px rgba(0,0,0,0.25);
                margin-bottom: 15px;
            }

        .main-image-placeholder {
            width: 100%;
            min-height: 350px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image-gallery {
            display: flex;
            gap: 10px;
        }

            .product-image-gallery .thumbnail {
                width: 70px;
                height: 70px;
                object-fit: cover;
                border-radius: 8px;
                cursor: pointer;
                border: 2px solid transparent;
                transition: border-color 0.3s;
            }

                .product-image-gallery .thumbnail:hover,
                .product-image-gallery .thumbnail.active {
                    border-color: var(--accent-yellow);
                }

        .product-details-section {
            flex: 1.3;
            min-width: 300px;
        }

            .product-details-section h1 {
                border: none;
                padding: 0;
                margin: 0 0 10px 0;
                font-size: 2.2rem;
                text-align: right;
            }

        .price-badge-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        #productPagePrice {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--accent-yellow);
        }

        .product-platform-info {
                        display: flex;
                        align-items: center;
                        justify-content: center; /* تم التعديل هنا */
                        gap: 8px;
                        margin: -10px 0 15px 0;
                        font-size: 1rem;
                        color: var(--light-text);
                   
        }

            .product-platform-info img {
                height: 24px;
                width: 24px;
            }

            .product-platform-info span, .product-platform-info strong {
                line-height: 1;
            }

        .product-detail-badge {
            font-size: 14px;
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 20px;
            color: white;
        }

            .product-detail-badge.bestseller {
                background-color: #ff4757;
            }

            .product-detail-badge.special {
                background-color: #3742fa;
            }

        #productPageShortDescription {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            color: var(--light-text);
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
        }

            .quantity-selector label {
                font-weight: bold;
            }

            .quantity-selector button {
                width: 40px;
                height: 40px;
                padding: 0;
                margin: 0;
                font-size: 1.5rem;
                line-height: 40px;
                text-align: center;
            }

            .quantity-selector input {
                width: 60px;
                text-align: center;
                margin: 0;
                font-size: 1.2rem;
                font-weight: bold;
                -moz-appearance: textfield;
            }

                .quantity-selector input::-webkit-outer-spin-button,
                .quantity-selector input::-webkit-inner-spin-button {
                    -webkit-appearance: none;
                    margin: 0;
                }

        .add-to-cart-product-page {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            background-color: var(--green-buy-btn);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
        }

            .add-to-cart-product-page:hover {
                background-color: var(--green-buy-btn-hover);
                transform: translateY(-3px) scale(1.02);
                box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
            }

        .tabs-container {
            width: 100%;
            margin-bottom: 40px;
        }

        .tab-buttons {
            border-bottom: 2px solid var(--main-purple);
        }

        .tab-button {
            padding: 15px 25px;
            cursor: pointer;
            background: none;
            border: none;
            color: var(--light-text);
            font-size: 16px;
            font-weight: bold;
            position: relative;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

            .tab-button::after {
                content: '';
                position: absolute;
                bottom: -2px;
                left: 0;
                width: 100%;
                height: 2px;
                background-color: var(--accent-yellow);
                transform: scaleX(0);
                transition: transform 0.3s ease;
            }

            .tab-button.active {
                opacity: 1;
            }

                .tab-button.active::after {
                    transform: scaleX(1);
                }

        .tab-content {
            display: none;
            padding: 25px 10px;
            animation: fadeIn 0.5s;
            background-color: rgba(0,0,0,0.2);
            border-radius: 0 0 8px 8px;
        }

            .tab-content.active {
                display: block;
            }

        #reviews-section {
            width: 100%;
        }

        .comment-rating .star {
            font-size: 16px;
            color: #ccc;
        }

            .comment-rating .star.filled {
                color: var(--accent-yellow);
            }

        .comment-card {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-right: 3px solid var(--accent-yellow);
        }

        .comment-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .comment-author {
            font-weight: bold;
            color: var(--accent-yellow);
        }

        .comment-text {
            margin: 0;
            line-height: 1.7;
        }

        .comment-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 600px;
            margin: 20px auto;
        }

            .comment-form input, .comment-form textarea {
                width: 100%;
                box-sizing: border-box;
                margin-top: 0;
            }

        .rating-input {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

            .rating-input .stars {
                direction: ltr;
            }

            .rating-input .star {
                font-size: 2rem;
                color: #ccc;
                cursor: pointer;
                transition: color 0.2s;
            }

            .rating-input .stars:hover .star {
                color: var(--accent-yellow);
            }

            .rating-input .star:hover ~ .star {
                color: #ccc;
            }

            .rating-input .stars[data-rating="1"] .star:nth-child(n+5),
            .rating-input .stars[data-rating="2"] .star:nth-child(n+4),
            .rating-input .stars[data-rating="3"] .star:nth-child(n+3),
            .rating-input .stars[data-rating="4"] .star:nth-child(n+2),
            .rating-input .stars[data-rating="5"] .star:nth-child(n+1) {
                color: var(--accent-yellow);
            }

        #loadMoreComments {
            display: block;
            margin: 20px auto;
        }

        .comment-footer {
            margin-top: 15px;
            font-size: 12px;
            color: #aaa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

            .comment-footer .helpful-btn {
                background: none;
                border: 1px solid var(--accent-yellow);
                color: var(--accent-yellow);
                padding: 2px 8px;
                font-size: 12px;
                border-radius: 5px;
                margin: 0;
            }

                .comment-footer .helpful-btn:disabled {
                    background-color: #333;
                    color: #888;
                    border-color: #555;
                    cursor: not-allowed;
                }

        .product-page-rating {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

            .product-page-rating .stars {
                font-size: 1.5rem;
            }

                .product-page-rating .stars .star {
                    color: var(--accent-yellow);
                }

                    .product-page-rating .stars .star.empty {
                        color: #555;
                    }

            .product-page-rating .rating-summary {
                font-size: 1rem;
                color: var(--light-text);
            }

        .product-page-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .add-to-cart-text-btn {
            padding: 12px 20px;
            font-size: 16px;
            margin-top: 15px;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            background-color: var(--green-buy-btn);
            color: white;
            transition: transform 0.3s ease, background-color 0.3s ease;
            font-family: 'Cairo', sans-serif;
            display: flex;
            align-items: center;
            gap: 8px;
        }

            .add-to-cart-text-btn img {
                width: 20px;
                height: 20px;
                margin: 0;
                padding: 0;
            }

            .add-to-cart-text-btn:hover {
                background-color: var(--green-buy-btn-hover);
            }

        .buy-btn-product-page {
            background-color: var(--green-buy-btn);
            color: white;
        }

            .buy-btn-product-page:hover {
                background-color: var(--green-buy-btn-hover);
            }

        .discord-button {
            display: inline-flex;
            align-items: center;
            background-color: #5865f2;
            color: var(--white-text);
            font-weight: bold;
            text-decoration: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 18px;
            margin-top: 20px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
        }

            .discord-button:hover {
                background-color: #4b58b4;
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            }

            .discord-button img {
                height: 24px;
                width: 24px;
                margin-left: 10px;
                vertical-align: middle;
            }

        #home .home-section-buttons {
            justify-content: center;
        }

        .home-section-buttons {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .vodafone-number-highlight {
            color: var(--accent-yellow);
            font-weight: bold;
        }

        #footer {
            background-color: var(--main-purple);
            color: var(--light-text);
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

            #footer h3 {
                margin-right: 0;
                border-right: none;
                padding-right: 0;
                font-size: 20px;
                margin-bottom: 20px;
            }

        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .footer-link {
            color: var(--light-text);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s ease;
        }

            .footer-link:hover {
                color: var(--accent-yellow);
            }

            .footer-link img {
                height: 18px;
                width: 18px;
                vertical-align: middle;
                margin-left: 8px;
            }

        #copyright {
            font-size: 14px;
            color: rgba(224, 224, 224, 0.7);
        }

        .store-logo-on-homepage {
            display: block;
            width: 150px;
            margin: 20px auto;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .auth-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .login-container, .signup-container {
            background-color: var(--main-purple);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            width: 350px;
            border: 1px solid #8e6abf;
        }

            .login-container h2, .signup-container h2 {
                border: none;
                margin-right: 0;
            }

            .login-container input, .signup-container input {
                display: block;
                width: 100%;
                box-sizing: border-box;
                margin-bottom: 15px;
            }

        .support-form-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #supportFormStatus {
            margin-top: 15px;
            font-weight: bold;
        }

        .product-buttons-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .product-item .buy-btn {
            background-color: var(--green-buy-btn);
            color: white;
            font-size: 14px;
            padding: 8px 15px;
            margin-top: 0;
        }

        .product-item .add-to-cart-btn {
            padding: 0;
            border: none;
            background-color: transparent;
            cursor: pointer;
            width: auto;
            margin-top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .product-item .add-to-cart-btn img {
                width: 31px;
                height: 31px;
                transition: transform 0.3s ease, filter 0.3s ease;
            }

            .product-item .add-to-cart-btn:hover img {
                transform: scale(1.15);
                filter: brightness(1.2);
            }

        .product-item .buy-btn:hover {
            background-color: var(--green-buy-btn-hover);
        }

        .product-item .add-to-cart-btn:hover {
            background-color: transparent;
        }

        #comments-section {
            width: 100%;
            text-align: center;
        }

            #comments-section h3 {
                margin-right: 0;
                padding-right: 0;
            }

        #comments-modal .comment-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .comment-form input, .comment-form textarea {
            width: 80%;
            max-width: 350px;
            display: block;
            margin-right: auto;
            margin-left: auto;
            text-align: right;
        }

        .comment-form button {
            margin-right: auto;
            margin-left: auto;
        }

        #commentList {
            margin-top: 20px;
            text-align: right;
        }

        .comment-item {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            text-align: right;
        }

            .comment-item strong {
                color: var(--accent-yellow);
            }

            .comment-item p {
                margin: 5px 0 0 0;
                font-size: 14px;
            }

        /* === START: New Cart Organization CSS === */
        .cart-modal-item {
            display: flex;
            align-items: center;
            gap: 15px; /* مسافة ثابتة بين العناصر */
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

            .cart-modal-item img {
                width: 50px;
                height: 50px; /* حجم موحد */
                object-fit: cover;
                border-radius: 6px;
                flex-shrink: 0; /* لمنع الصورة من الانكماش */
            }

            .cart-modal-item .item-details {
                flex-grow: 1; /* لجعل هذا الجزء يأخذ المساحة المتاحة */
                text-align: right;
                margin: 0;
                padding: 0;
            }

                .cart-modal-item .item-details h4 {
                    margin: 0 0 4px 0;
                    font-size: 15px;
                    line-height: 1.3;
                }

                .cart-modal-item .item-details p {
                    margin: 0;
                    font-size: 14px;
                    color: var(--accent-yellow);
                    font-weight: bold;
                }

            .cart-modal-item .quantity-controls {
                display: flex;
                align-items: center;
                gap: 8px;
                flex-shrink: 0; /* لمنع أزرار الكمية من الانكماش */
            }
            /* === END: New Cart Organization CSS === */

            .cart-modal-item img {
                width: 50px;
                height: auto;
                border-radius: 5px;
                margin-left: 10px;
            }

            .cart-modal-item .item-details {
                flex-grow: 1;
            }

                .cart-modal-item .item-details h4 {
                    margin: 0;
                    font-size: 16px;
                }

                .cart-modal-item .item-details p {
                    margin: 5px 0 0;
                    font-size: 14px;
                }

            .cart-modal-item .quantity-controls {
                display: flex;
                align-items: center;
                gap: 5px;
            }

                .cart-modal-item .quantity-controls button {
                    padding: 5px 10px;
                    min-width: 30px;
                    margin: 0;
                    font-size: 16px;
                    background-color: var(--accent-yellow);
                    color: var(--black-text);
                }

                .cart-modal-item .quantity-controls span {
                    font-size: 16px;
                    min-width: 20px;
                    text-align: center;
                }

          
        .cart-modal-total {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
        }

        .modal .modal-content-section {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

            .modal .modal-content-section.is-visible {
                display: block;
                opacity: 1;
            }

        .modal-form-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 15px;
            align-items: center;
            margin: 20px 0;
        }

            .modal-form-grid label {
                text-align: right;
                white-space: nowrap;
            }

            .modal-form-grid select,
            .modal-form-grid input {
                width: 100%;
                margin-top: 0;
            }

        .modal-options-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

            .modal-options-container select {
                width: auto;
                min-width: 200px;
            }

        #feedback-section {
            padding: 30px;
            text-align: center;
        }

            #feedback-section h2 {
                border-right: none;
                margin-right: 0;
            }

        .feedback-form-container {
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        #feedback-message {
            margin-top: 15px;
            font-weight: bold;
        }

        .rating-section {
            width: 100%;
            text-align: center;
            margin-top: 20px;
        }

        .rating-stars {
            font-size: 30px;
            color: #ddd;
            cursor: pointer;
            direction: ltr;
            display: inline-block;
        }

            .rating-stars .star {
                display: inline-block;
                transition: color 0.2s ease, transform 0.2s ease;
                color: #ddd;
            }

                .rating-stars .star:hover {
                    transform: scale(1.2);
                    color: var(--accent-yellow);
                }

                    .rating-stars .star:hover ~ .star {
                        color: #ddd;
                    }

                .rating-stars .star.selected {
                    color: var(--accent-yellow);
                }

        .product-card-rating {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            margin-bottom: 8px;
        }

            .product-card-rating .star {
                color: #ccc;
                font-size: 16px;
            }

                .product-card-rating .star.filled {
                    color: var(--accent-yellow);
                }

        .rating-average {
            font-size: 20px;
            font-weight: bold;
            color: var(--accent-yellow);
            margin-top: 10px;
        }

        #rateMessage {
            font-size: 14px;
            margin-top: 10px;
        }

        #home .main-products-section {
            margin-top: 40px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

            #home .main-products-section::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-image: url('wallpaper.png');
                background-size: cover;
                background-position: center;
                filter: blur(5px);
                -webkit-filter: blur(5px);
                z-index: -1;
                border-radius: 12px;
            }

        .checkout-btn-centered {
            display: block;
            margin-left: auto;
            margin-right: auto;
            background-color: var(--green-buy-btn);
            color: white;
        }

            .checkout-btn-centered:hover {
                background-color: var(--green-buy-btn-hover);
            }

        .payment-method-card {
            background-color: var(--main-purple);
            border: 1px solid #8e6abf;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

            .payment-method-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            }

            .payment-method-card h3 {
                margin-top: 0;
                margin-bottom: 10px;
                text-align: center; /* This line should be added or kept */
            }

                /* You can keep the rest of the code as is. */

                .payment-method-card h3 img {
                    height: 25px;
                    margin-left: 10px;
                }

            .payment-method-card p {
                margin: 0;
            }

        .modal .modal-header {
            text-align: center;
        }

        .payment-header-container {
            display: flex;
            justify-content: space-around;
            align-items: stretch;
            gap: 10px;
            text-align: center;
            margin-bottom: 25px;
            width: 100%;
        }

        .payment-header-box {
            background-color: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

            .payment-header-box h4 {
                margin: 0 0 5px 0;
                font-size: 14px;
                color: var(--light-text);
                opacity: 0.8;
                font-weight: normal;
                border: none;
                padding: 0;
            }

            .payment-header-box .payment-total-amount-value,
            .payment-header-box .payment-timer-value {
                margin: 0;
                font-size: 18px;
                font-weight: bold;
                color: var(--accent-yellow);
            }

        .payment-timer-value.expired {
            color: red;
            animation: shake 0.5s ease-in-out;
        }

        .quantity-selector-card {
            background-color: #1b2838;
            border-radius: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 20px;
            margin: 15px auto;
            max-width: 300px;
            text-align: center;
        }

            .quantity-selector-card h4 {
                color: white;
                font-size: 1.25rem;
                font-weight: bold;
                margin: 0 0 15px 0;
                border: none;
                padding: 0;
            }

            .quantity-selector-card .quantity-controls {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
            }

            .quantity-selector-card .quantity-btn {
                background-color: #00a8ff;
                color: white;
                border: none;
                border-radius: 8px;
                width: 40px;
                height: 40px;
                font-size: 1.5rem;
                font-weight: bold;
                cursor: pointer;
                transition: background-color 0.3s ease;
                padding: 0;
                margin: 0;
                line-height: 40px;
            }

                .quantity-selector-card .quantity-btn:hover {
                    background-color: #007bb5;
                }

            .quantity-selector-card .quantity-input {
                width: 60px;
                padding: 8px;
                text-align: center;
                font-size: 1.2rem;
                font-weight: bold;
                border: 1px solid #00a8ff;
                background-color: #110e1a;
                color: white;
                border-radius: 8px;
                -moz-appearance: textfield;
            }

                .quantity-selector-card .quantity-input::-webkit-outer-spin-button,
                .quantity-selector-card .quantity-input::-webkit-inner-spin-button {
                    -webkit-appearance: none;
                    margin: 0;
                }

            .quantity-selector-card .quantity-total {
                color: white;
                font-size: 1.1rem;
                font-weight: bold;
                margin-top: 20px;
                margin-bottom: 0;
            }

        .product-image-fly {
            position: fixed;
            z-index: 9999;
            border-radius: 10%;
            transition: all 0.8s cubic-bezier(0.55, 0.055, 0.675, 0.19);
            pointer-events: none;
        }

        #productPage.section {
            background: linear-gradient(145deg, #1f1133, #110e1a);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid var(--main-purple);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            margin: 20px auto;
            max-width: 1200px;
        }

        .product-main-view {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            align-items: flex-start;
        }

            .product-main-view .product-image-section {
                order: 1;
            }

            .product-main-view .product-details-section:nth-of-type(3) {
                order: 2;
                flex: 1.3;
            }

        #productPageFullDescription {
            order: 3;
            flex-basis: 100%;
            margin-top: 30px;
            padding: 25px;
            border-top: 1px solid var(--main-purple);
            background-color: rgba(0,0,0,0.2);
            border-radius: 8px;
        }

            #productPageFullDescription h2 {
                border-right: 3px solid var(--accent-yellow);
                padding-right: 10px;
                margin-bottom: 20px;
                display: inline-block;
            }

        #productPageTitle {
            font-size: 2.5rem;
            color: var(--white-text);
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.3);
            margin-bottom: 15px;
        }

        #productPagePrice {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .product-page-rating {
            margin-bottom: 20px;
        }

        #productPageShortDescription {
            font-size: 1.1rem;
            color: #d1cde0;
            margin-bottom: 30px;
        }

        .quantity-selector {
            background-color: rgba(0,0,0,0.2);
            padding: 10px;
            border-radius: 50px;
            display: inline-flex;
            margin-bottom: 30px;
            align-items: center;
        }

            .quantity-selector label {
                font-size: 1rem;
                padding-left: 10px;
            }

            .quantity-selector button {
                background-color: var(--main-purple);
                color: var(--white-text);
                border-radius: 50%;
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
                border: none;
                line-height: 1;
            }

                .quantity-selector button:hover {
                    background-color: #6a4f8a;
                    transform: scale(1.1);
                }

            .quantity-selector input {
                background: transparent;
                border: none;
                color: var(--white-text);
                font-size: 1.3rem;
                width: 50px;
            }

        .tabs-container {
            margin-top: 40px;
        }

        .tab-buttons {
            border-bottom: 1px solid var(--main-purple);
            margin-bottom: 20px;
        }

        .tab-button {
            color: var(--light-text);
            opacity: 0.7;
            padding: 12px 20px;
            font-size: 1rem;
        }

            .tab-button.active {
                opacity: 1;
                color: var(--accent-yellow);
            }

        .tab-content {
            background-color: transparent;
            padding: 10px 5px;
        }


        /* === التحسينات الجديدة === */

        /* 1. إشعار مؤقت (Toast) */
        #toast-container {
            position: fixed;
            top: 80px;
            left: 20px; /* في RTL، جهة اليسار هي المكان المناسب لتجنب تغطية زر السلة */
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }

        .toast-notification {
            background-color: var(--green-buy-btn);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            opacity: 0;
            transform: translateX(-120%);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            font-weight: bold;
        }

            .toast-notification.show {
                opacity: 1;
                transform: translateX(0);
            }


        /* 2. زر العودة في صفحة المنتج */
        .back-button {
            margin-bottom: 20px;
            background-color: transparent;
            border: 2px solid var(--accent-yellow);
            color: var(--accent-yellow);
            font-size: 16px;
        }

            .back-button:hover {
                background-color: var(--accent-yellow);
                color: var(--black-text);
                transform: translateY(-2px);
            }


        /* === START: New Discount Code Style === */
        .discount-code-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px auto 10px;
            max-width: 300px; /* تحديد عرض أقصى */
        }

            .discount-code-container input {
                width: 100%;
                margin-top: 0;
                text-align: center;
                border: 1px solid var(--main-purple);
                border-left: none;
                border-radius: 0 8px 8px 0; /* زوايا دائرية لليمين فقط */
            }

            .discount-code-container button {
                margin-top: 0;
                padding: 12px 15px;
                font-size: 14px;
                border-radius: 8px 0 0 8px; /* زوايا دائرية لليسار فقط */
                white-space: nowrap; /* لمنع التفاف النص */
                border: 1px solid var(--main-purple);
            }
            /* === END: New Discount Code Style === */

            .discount-code-container input {
                width: 150px;
                margin-top: 0;
                text-align: center;
            }

            .discount-code-container button {
                margin-top: 0;
                padding: 10px 15px;
                font-size: 14px;
            }

        .discount-message {
            text-align: center;
            font-size: 14px;
            min-height: 20px;
            font-weight: bold;
        }

            .discount-message.success {
                color: var(--green-buy-btn);
            }

            .discount-message.error {
                color: #ff4757;
            }

        #cartTotalContainer .original-price {
            text-decoration: line-through;
            opacity: 0.7;
            font-size: 16px;
            margin-left: 10px;
        }

        /* === START: CSS for Navbar Search Bar === */
        .navbar-search-container {
            display: flex;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            padding: 4px 8px;
            margin-left: 15px;
            transition: background-color 0.3s ease;
        }

            .navbar-search-container:hover {
                background-color: rgba(0, 0, 0, 0.3);
            }

        .navbar-search-input {
            background: transparent;
            border: none;
            outline: none;
            color: var(--light-text);
            font-family: 'Tajawal', sans-serif;
            width: 120px; /* Start small */
            transition: width 0.4s ease-in-out;
            padding: 2px 5px;
            margin: 0; /* Override default input margin */
        }

            .navbar-search-input::placeholder {
                color: rgba(224, 224, 224, 0.6);
            }

            .navbar-search-input:focus {
                width: 180px;
            }

        .navbar-search-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 5px;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--light-text);
        }

            .navbar-search-btn svg {
                fill: currentColor;
                transition: color 0.3s ease;
            }

            .navbar-search-btn:hover {
                color: var(--accent-yellow);
                background-color: transparent; /* Override default button hover */
                transform: none; /* Override default button hover */
            }
        /* === END: CSS for Navbar Search Bar === */
        /* === Trust Badges CSS === */
        .trust-badges-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--light-text);
            font-size: 14px;
            font-weight: bold;
        }

            .trust-badge svg {
                width: 28px;
                height: 28px;
                color: var(--accent-yellow);
            }
        /* === Modal Trust Badges CSS === */
        .modal-trust-badges {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

            .modal-trust-badges .trust-badge {
                font-size: 12px;
            }

                .modal-trust-badges .trust-badge svg {
                    width: 20px;
                    height: 20px;
                }

        /* 4. تحسينات التجاوب مع الشاشات */
        @media (max-width: 1024px) {
            #navbar .nav-link, .dropdown .nav-link {
                margin-left: 10px;
                font-size: 13px;
            }
        }

        @media (max-width: 860px) {
            #navbar {
                flex-wrap: wrap;
                justify-content: center;
                padding-bottom: 8px;
            }

                #navbar .logo-area {
                    width: 100%;
                    justify-content: center;
                    margin-bottom: 5px;
                    margin-left: 0;
                }

                #navbar .nav-link, .dropdown > .nav-link {
                    padding-bottom: 2px;
                }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 120px; /* تعديل ليتناسب مع الشريط العلوي الملتف */
                padding-bottom: 80px;
            }

            .product-item {
                width: calc(50% - 20px);
                min-width: 150px;
            }

                .product-item.valorant-item {
                    width: calc(50% - 20px);
                }

            .subscription-item {
                width: 90%;
                max-width: 340px;
            }

            .product-main-view {
                flex-direction: column;
            }

            .product-image-section, .product-details-section {
                min-width: 100%;
            }

            #productPage {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .products-container {
                gap: 15px;
            }

            .product-item {
                width: 85%;
            }

            .modal {
                width: 95%;
                padding: 15px;
            }

                .modal input, .modal textarea {
                    width: 90%;
                }

            .payment-header-container {
                flex-direction: column;
            }

            #shipping {
                padding: 10px;
            }

            #orderInputContainer input {
                width: 180px;
            }
        }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div id="navbar">
        <div class="logo-area">
            <img src="./images/BerlinStore.png" alt="Store Logo">
            <div class="logo-text-container">
                <span class="by-sohayl">By <a href="https://konect.gg/sohayl" target="_blank">Sohayl</a></span>
                <span class="country-name">
                    <span class="flag-emoji">🇪🇬</span>
                    Egypt
                </span>
            </div>
        </div>
        <a href="#home" class="nav-link">الرئيسية</a>
        <a href="#products" class="nav-link">المنتجات</a>
        <a href="#subscriptions" class="nav-link">الاشتراكات</a>
        <a href="#fortnite" class="nav-link">Fortnite</a>
        <a href="#valorantPoints" class="nav-link">Valorant Points</a>
        <a href="#roblox" class="nav-link">Roblox</a>
        <div class="dropdown">
            <div class="nav-link">Steam</div>
            <div class="dropdown-content">
                <a href="#steamGiftCards">Steam Gift Cards</a>
                <a href="#steamPoints">Steam Points</a>
                <a href="#steamGamesGifting">Steam Games Gifting</a>
            </div>
        </div>
        <div id="searchResults" class="section">
            <h2 id="searchResultsTitle">نتائج البحث</h2>
            <div class="products-container" id="searchResultsContainer">
            </div>
            <p id="noResultsMessage" style="text-align: center; display: none; margin-top: 30px;">
                عذراً، لم يتم العثور على منتجات تطابق بحثك.
            </p>
        </div>
        <a href="#shipping" class="nav-link">تتبع الشحن</a>
        <div class="navbar-search-container">
            <input type="text" id="navbarProductSearch" class="navbar-search-input" placeholder="ابحث..." onkeyup="if(event.key === 'Enter') performNavbarSearch()">
            <button class="navbar-search-btn" onclick="performNavbarSearch()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                </svg>
            </button>
        </div>
        <div class="support-button" onclick="showModal('supportModal')">
            <img class="support-icon" src="./images/supp.png" alt="Support Icon">
            Support
        </div>
    </div>

    <div class="fixed-cart-button" onclick="showModal('cartModal'); renderCart();">
        <img src="./images/cartt.png" alt="Cart Icon">
        <span id="cart-count">0</span>
    </div>

    <div id="home" class="section glass-card" style="text-align: center;">
        <h2>أهلاً بك في Berlin Store! 👋</h2>
        <img src="./images/BerlinStore.png" alt="Berlin Store Logo" class="store-logo-on-homepage">
        <p>اكتشف منتجاتنا الجديدة وتتبع حالة طلباتك بسهولة.</p>
        <div class="home-section-buttons">
            <a href="https://discord.gg/D3shcEb5xe" target="_blank" class="discord-button">
                <span>انضم لسيرفر الديسكورد</span>
                <img src="./images/discord.png" alt="Discord Logo">
            </a>
            <button onclick="window.location.hash = '#shipping'" style="background-color: var(--accent-yellow); color: var(--black-text);">تتبع شحن وتوصيل طلبك</button>
        </div>

        <div id="games-section" class="main-products-section glass-card darker">
            <h2>المنتجات</h2>
            <div class="products-container" id="gamesContainer">
            </div>
        </div>

        <div id="subscriptions-section" class="main-products-section glass-card darker">
            <h2>الاشتراكات</h2>
            <div class="products-container" id="homeSubscriptionsContainer">
            </div>
        </div>

        <div id="game-topup-section" class="main-products-section glass-card darker">
            <h2>شحن الألعاب</h2>
            <div class="products-container" id="gameTopupContainer">

                <div class="product-item category-card" onclick="window.location.hash='#valorantPoints'">
                    <div class="product-image-wrapper">
                        <img src="./images/reyna - Copy.png" alt="شحن فالورانت">
                    </div>
                    <h3>شحن فالورانت<br><small>(Valorant Points)</small></h3>
                </div>

                <div class="product-item category-card" onclick="window.location.hash='#fortnite'">
                    <div class="product-image-wrapper">
                        <img src="./images/fortnite33.png" alt="شحن فورتنايت">
                    </div>
                    <h3>شحن فورتنايت<br><small>(V-Bucks & Packs)</small></h3>
                </div>

                <div class="product-item category-card" onclick="window.location.hash='#roblox'">
                    <div class="product-image-wrapper">
                        <img src="./images/Roblox-10.png" alt="شحن روبلوكس">
                    </div>
                    <h3>شحن<br>روبلوكس<br><small>(Robux)</small></h3>
                </div>

            </div>
        </div>

        <div id="offline-steam-section" class="main-products-section glass-card darker">
            <h2>  حسابات ستيم ( اوفلاين دائم - اونلاين ايجار )</h2>
            <div class="products-container" id="offlineSteamContainer">
            </div>
        </div>



        <div id="steam-gift-cards-section" class="main-products-section glass-card darker">
            <h2>Steam Gift Cards</h2>
            <div class="products-container" id="steamGiftCardsHomeContainer">
            </div>
        </div>

        <div id="steam-points-section" class="main-products-section glass-card darker">
            <h2>Steam Points</h2>
            <div class="products-container" id="steamPointsContainer">
            </div>
        </div>

        <div id="feedback-section" class="glass-card">
            <h2>تقييمات المتجر</h2>
            <p>شاهد آراء عملائنا وشاركنا تجربتك مع Berlin Store!</p>

            <div id="store-average-rating-display">
                <div class="loading-spinner" style="margin: 20px auto;"></div>
            </div>

            <div id="store-reviews-list" style="max-width: 600px; margin: 0 auto;">
            </div>

            <div class="reviews-carousel-container">
                <div id="store-reviews-list" class="reviews-carousel-track">
                </div>
            </div>
            <input type="text" id="rating-name" placeholder="اسمك" required>

            <div class="rating-input">
                <div class="stars" id="storeRatingStars" data-rating="0">
                    <span class="star" data-value="5">☆</span>
                    <span class="star" data-value="4">☆</span>
                    <span class="star" data-value="3">☆</span>
                    <span class="star" data-value="2">☆</span>
                    <span class="star" data-value="1">☆</span>
                </div>
                <input type="hidden" id="storeRatingInput" value="0">
            </div>

            <textarea id="rating-text" rows="3" placeholder="اكتب تعليقك (اختياري)"></textarea>
            <button onclick="submitStoreRating()">أضف تقييمك</button>
            <div id="feedback-message"></div>
        </div>
        </div>

    <div id="products" class="section">
        <h2 style="margin-right: 0;">منتجاتنا المتوفرة</h2>
        <div class="search-bar-container">
            <input type="text" id="productSearch" placeholder="ابحث عن منتج...">
            <button onclick="searchProducts()">بحث</button>
        </div>
        <div class="products-container" id="productsContainer">
        </div>
    </div>

    <div id="subscriptions" class="section">
        <h2 style="margin-right: 0;">اشتراكاتنا المتوفرة</h2>
        <div class="products-container" id="subscriptionsContainer">
        </div>
    </div>

    <div id="valorantPoints" class="section">
        <h2 style="margin-right: 0;">Valorant Points</h2>
        <div class="products-container" id="valorantPointsPageContainer">
        </div>
    </div>

    <div id="roblox" class="section">
        <h2 style="margin-right: 0;">Robux</h2>
        <div class="products-container" id="robloxContainer">
        </div>
    </div>

    <div id="fortnite" class="section" style="background-image: url('./images/fortnitewallpaper.png'); background-size: cover; background-position: center; border-radius: 15px;">
        <h2 style="margin-right: 0;">V-Bucks & Packs</h2>
        <div class="products-container" id="fortniteContainer">
        </div>
    </div>

    <div id="steamPoints" class="section">
        <h2 style="margin-right: 0;">Steam Points</h2>
        <div class="products-container" id="steamPointsPageContainer">
        </div>
    </div>

    <div id="steamGiftCards" class="section">
        <h2 style="margin-right: 0;">Steam Gift Cards</h2>
        <div class="products-container" id="steamGiftCardsPageContainer">
        </div>
    </div>

    <div id="steamGamesGifting" class="section">
        <h2 style="margin-right: 0;">Steam Games Gifting</h2>
        <p style="text-align: center; margin-bottom: 20px;">أرسل أي لعبة كهدية لأصدقائك على ستيم مباشرةً!</p>
        <div class="products-container" id="steamGamesGiftingContainer">
        </div>
    </div>

    <div id="shipping" class="section glass-card">
        <h1>تتبع شحن طلبك</h1>
        <div id="orderInputContainer">
            <label for="orderCode">أدخل كود الطلب الخاص بك</label>
            <p id="shippingDescription">الصفحة دي لتتبع شحن وتوصيل المنتجات فقط وليس لها علاقة بالvideo gaming</p>
            <div>
                <input type="text" id="orderCode" placeholder="مثال: 74562341">
                <button onclick="checkOrder()">بحث</button>
            </div>
        </div>
        <div id="statusContainer" class="glass-card">
            <div id="resultText"></div>
            <img id="statusImage" src="" alt="">
        </div>
    </div>

    <div id="about" class="section glass-card content-page">
        <h2>من نحن؟</h2>
        <p>أهلاً بك في متجر Berlin Store، وجهتك الأولى لكل ما يتعلق بعالم الألعاب والترفيه الرقمي.</p>
        <p>نحن فخورون بأن نكون جزءًا من مجموعة <strong>Gamers Online Entertainment (GOE)</strong>، وهذا المتجر هو بوابتنا الإلكترونية الرسمية لتقديم أفضل المنتجات والخدمات لمجتمع اللاعبين في مصر والوطن العربي.</p>
        <p>هدفنا هو توفير تجربة شراء سهلة، آمنة، وسريعة، مع دعم فني متكامل لمساعدتك في كل خطوة. نسعى دائمًا لتقديم أحدث المنتجات بأفضل الأسعار، لأننا لاعبون مثلكم ونفهم ما تحتاجونه.</p>
    </div>

    <div id="terms" class="section glass-card content-page">
        <h2>شروط الخدمة</h2>
        <p>باستخدامك لمتجر Berlin Store، فإنك توافق على الشروط والأحكام التالية:</p>
        <ul>
            <li>جميع المنتجات المباعة هي منتجات رقمية، ويتم تسليمها عبر البريد الإلكتروني أو مباشرة إلى حسابك.</li>
            <li>يجب على المشتري تقديم معلومات صحيحة ودقيقة (مثل البريد الإلكتروني أو Riot ID) لضمان التسليم الصحيح.</li>
            <li>المتجر غير مسؤول عن أي أخطاء ناتجة عن إدخال معلومات غير صحيحة من قبل العميل.</li>
            <li>نضمن أمان جميع الحسابات والمنتجات المباعة من خلالنا. في حالة وجود أي مشكلة، يرجى التواصل مع الدعم الفني فورًا.</li>
            <li>جميع الأسعار المعروضة نهائية وقد تتغير بناءً على تحديثات السوق.</li>
        </ul>
    </div>

    <div id="privacy" class="section glass-card content-page">
        <h2>سياسة الخصوصية</h2>
        <p>في Berlin Store، خصوصيتك هي أولويتنا القصوى. نحن نلتزم بحماية بياناتك الشخصية وعدم مشاركتها مع أي طرف ثالث.</p>
        <ul>
            <li>**جمع المعلومات:** نقوم بجمع المعلومات الضرورية فقط لإتمام عملية الشراء، مثل البريد الإلكتروني ورقم الهاتف (في حالة الدفع بفودافون كاش).</li>
            <li>**استخدام المعلومات:** تُستخدم معلوماتك فقط لغرض توصيل المنتج إليك والتواصل معك بخصوص طلبك.</li>
            <li>**أمان البيانات:** نحن نستخدم بوابات دفع آمنة (Formspree) لمعالجة الطلبات، ولا نقوم بتخزين أي معلومات دفع حساسة على خوادمنا.</li>
            <li>**ملفات تعريف الارتباط (Cookies):** قد نستخدم ملفات تعريف الارتباط لتحسين تجربة التصفح وحفظ محتويات سلة التسوق الخاصة بك.</li>
        </ul>
    </div>

    <div id="productPage" class="section glass-card">
        <button class="back-button" onclick="history.back()">&larr; العودة</button>
        <div id="productPageContent">
            <div class="product-main-view">
                <div id="productPageFullDescription" class="product-details-section">
                </div>
                <div class="product-image-section">
                    <div id="mainImageContainer">
                        <div class="main-image-placeholder">
                            <div class="loading-spinner"></div>
                        </div>
                        <img id="productPageImage" src="" alt="Product Image" class="main-image" style="display: none;">
                    </div>
                    <div class="product-image-gallery" id="productImageGallery">
                    </div>
                </div>

                <div class="product-details-section">
                    <h1 id="productPageTitle"></h1>
                    <div class="price-badge-container">
                        <span id="productPagePrice"></span>
                        <span id="productPageBadge"></span>
                    </div>
                    <p id="productPageShortDescription"></p>
                    <div id="productPageAverageRating" class="product-page-rating"></div>
                    <div id="productPagePlatform" class="product-platform-info"></div>

                    <button id="addToCartBtn" class="add-to-cart-product-page">أضف إلى السلة</button>
                    <div class="quantity-selector">
                        <label for="productPageQuantity">الكمية:</label>
                        <button id="decreaseProductPageQuantity">-</button>
                        <input type="number" id="productPageQuantity" value="1" min="1">
                        <button id="increaseProductPageQuantity">+</button>
                    </div>
                </div>
            </div>

            <div class="tabs-container">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="specs">المواصفات</button>
                    <button class="tab-button" data-tab="customer-reviews">تقييمات العملاء</button>
                    <button class="tab-button" data-tab="extra-info">معلومات إضافية</button>
                    <button class="tab-button" data-tab="faq">أسئلة وأجوبة</button>
                </div>
                <div id="specs" class="tab-content active">
                </div>
                <div id="customer-reviews" class="tab-content">
                    <h3>اترك تعليقك</h3>
                    <form class="comment-form" onsubmit="submitComment(event)">
                        <input type="text" id="commentName" placeholder="اسمك" required>
                        <div class="rating-input">
                            <label>تقييمك:</label>
                            <div class="stars" id="ratingStars" data-rating="0">
                                <span class="star" data-value="5">☆</span>
                                <span class="star" data-value="4">☆</span>
                                <span class="star" data-value="3">☆</span>
                                <span class="star" data-value="2">☆</span>
                                <span class="star" data-value="1">☆</span>
                            </div>
                            <input type="hidden" id="commentRating" value="0">
                        </div>
                        <textarea id="commentText" rows="3" placeholder="اكتب تعليقك هنا... (اختياري)"></textarea>
                        <button type="submit">إرسال التعليق</button>
                    </form>
                    <hr style="border-color: rgba(255,255,255,0.2); margin: 30px 0;">
                    <h3>التعليقات</h3>
                    <div id="commentList"></div>
                    <button id="loadMoreComments" style="display:none;">تحميل المزيد</button>
                </div>
                <div id="extra-info" class="tab-content">
                    <p>جميع المنتجات رقمية ويتم تسليمها عبر البريد الإلكتروني أو مباشرة إلى حسابك.</p>
                </div>
                <div id="faq" class="tab-content">
                    <p>لأي استفسار أو مشكلة تواجهك، يرجى عدم التردد في التواصل معنا عبر البريد الإلكتروني للدعم الفني:</p>
                    <p><strong>Berlinstoregoe@gmail.com</strong></p>
                </div>
            </div>

        </div>
    </div>


    <div id="paymentModal" class="modal">
        <span class="close-btn" onclick="closeModal('paymentModal')">&times;</span>
        <div class="modal-body">
            <div id="modalCommonContent" class="modal-content-section is-visible">
                <img id="modalImage" src="" alt="Product Image" class="product-image">
                <h2 id="modalTitle"></h2>
                <div id="modalProductInfo" class="modal-product-info"></div>
                <p id="modalPrice"></p>
                <div id="steamProductQuantitySelector" style="display: none;">
                    <div class="quantity-selector-card">
                        <h4>الكمية</h4>
                        <div class="quantity-controls">
                            <button class="quantity-btn" id="decreaseQuantity">-</button>
                            <input type="number" class="quantity-input" id="quantityInput" value="1" min="1">
                            <button class="quantity-btn" id="increaseQuantity">+</button>
                        </div>
                        <p class="quantity-total">إجمالي المبلغ: <span id="totalPriceDisplay">0</span> ج.م</p>
                    </div>
                </div>

                <div id="account-details-container">
                    <input type="email" id="account_email" name="account_email" placeholder="ايميل الحساب">
                    <input type="text" id="account_password" name="account_password" placeholder="باسورد الحساب">
                    <input type="text" id="account_contact" name="account_contact" placeholder="وسيلة تواصل (رقمك مثلا)">
                </div>

                <div id="subscription-group" style="margin: 20px 0; display: none;">
                    <label style="display: block; margin-bottom: 12px; font-weight: bold; text-align: center;">اختر مدة الاشتراك:</label>
                    <div id="subscription-options-container"></div>
                </div>
                <div class="form-parallel-group">
                    <div id="riot-id-group" style="display: none;">
                        <label for="riot_id_input">Riot ID</label>
                        <input type="text" id="riot_id_input" placeholder="Name#TAG" required>
                    </div>
                    <div id="steam-friend-code-group" style="display: none;">
                        <label for="steam_friend_code_input">Steam Friend Code</label>
                        <input type="text" id="steam_friend_code_input" placeholder="أدخل كود الصداقة الخاص بك" required>
                    </div>
                    <div id="payment-method-group">
                        <label for="modalPaymentMethod">طريقة الدفع</label>
                        <select id="modalPaymentMethod">
                            <option value="vodafone">فودافون كاش</option>
                            <option value="paypal">بايبال</option>
                        </select>
                    </div>
                </div>
                <div style="text-align: center;">
                    <button id="modal-action-button">اذهب للدفع</button>
                </div>
            </div>

            <div id="vodafoneDetails" class="modal-content-section">
                <div class="payment-header-container">
                    <div class="payment-header-box">
                        <h4>الخطوة الحالية</h4>
                        <p class="payment-info-label">معلومات الدفع</p>
                    </div>
                    <div class="payment-header-box">
                        <h4>المبلغ المستحق</h4>
                        <p id="vodafoneTotalAmount" class="payment-total-amount-value"></p>
                    </div>
                    <div class="payment-header-box">
                        <h4>مهلة الدفع</h4>
                        <div id="vodafoneTimer" class="payment-timer-value"></div>
                    </div>
                </div>
                <p>
                    <div class="payment-info-box">
                        <div class="payment-instructions">
                            <p>
                                <img class="payment-logo" src="./images/vf-cash.png" alt="Vodafone Cash Logo">
                                قم بتحويل المبلغ من محفظة فودافون كاش على الرقم التالي: <br>
                                <strong class="vodafone-number-highlight">01060292953</strong>
                            </p>
                        </div>
                        <div class="qr-code-container">
                            <p>أو امسح رمز الـ QR للدفع مباشرةً:</p>
                            <img src="./images/vfqr.png" alt="Vodafone Cash QR Code" class="qr-code-image">
                        </div>
                    </div>
                    <form id="vodafoneForm" action="https://formspree.io/f/xgvldadg" method="POST" class="payment-details-form">
                        <input type="hidden" name="access_key" value="54b86a6e-bc6a-4f0a-98b6-dfe2c134c4bd">
                        <input type="hidden" name="product" id="vodafone_product_name">
                        <input type="hidden" name="price" id="vodafone_product_price">
                        <input type="hidden" name="Steam Friend Code" id="vodafone_steam_friend_code">
                        <input type="hidden" name="Riot ID" id="vodafone_riot_id">
                        <input type="hidden" name="Account Email" id="vodafone_account_email">
                        <input type="hidden" name="Account Password" id="vodafone_account_password">
                        <input type="hidden" name="Contact Method" id="vodafone_contact_method">
                        <input type="hidden" name="payment_method" value="Vodafone Cash">

                        <div class="payment-details-grid">
                            <div class="input-fields">
                                <input type="email" name="email" placeholder="أدخل إيميلك" required>
                                <input type="tel" name="phone_number" placeholder="الرقم اللي حولت منه" required>
                                <textarea name="notes" placeholder="أضف ملاحظة (اختياري)"></textarea>
                            </div>
                            <div class="button-container">
                                <button type="submit" class="confirm-payment-btn">تم الدفع!</button>
                            </div>
                        </div>

                        <input type="checkbox" name="botcheck" class="hidden" style="display: none;">
                        <div id="vodafoneFormResult" class="form-result"></div>
                    </form>
            </div>
            <div id="paypalDetails" class="modal-content-section">
                <div class="payment-header-container">
                    <div class="payment-header-box">
                        <h4>عنوان</h4>
                        <p>معلومات الدفع</p>
                    </div>
                    <div class="payment-header-box">
                        <h4>المبلغ المستحق</h4>
                        <p id="paypalTotalAmount" class="payment-total-amount-value"></p>
                    </div>
                    <div class="payment-header-box">
                        <h4>مهلة الدفع</h4>
                        <div id="paypalTimer" class="payment-timer-value"></div>
                    </div>
                </div>
                <p>
                    <img class="payment-logo" src="./images/paypal.png" alt="PayPal Logo">
                    ادفع على حساب PayPal هذا: <a href="https://paypal.me/SohayLLLLL" target="_blank"><strong>https://paypal.me/SohayLLLLL</strong></a>
                </p>
                <form id="paypalForm" action="https://formspree.io/f/xgvldadg" method="POST">
                    <input type="hidden" name="Steam Friend Code" id="paypal_steam_friend_code">
                    <input type="hidden" name="product" id="paypal_product_name">
                    <input type="hidden" name="price" id="paypal_product_price">
                    <input type="hidden" name="Riot ID" id="paypal_riot_id">
                    <input type="hidden" name="Account Email" id="paypal_account_email">
                    <input type="hidden" name="Account Password" id="paypal_account_password">
                    <input type="hidden" name="Contact Method" id="paypal_contact_method">
                    <input type="hidden" name="payment_method" value="PayPal">
                    <input type="text" name="paypal_info" placeholder="أدخل إيميلك أو اسمك على بايبال" required>
                    <input type="url" name="steam_profile_url" id="steamProfileUrl" placeholder="رابط بروفايل ستيم" required>
                    <button type="submit" class="confirm-payment-btn">تم الدفع!</button>
                </form>
            </div>
            <div id="loading" class="modal-content-section" style="text-align: center;">
                <div class="loading-spinner"></div>
                <p id="loading-text">جاري إرسال طلبك... من فضلك انتظر.</p>
            </div>
            <div id="confirmationMessage" class="modal-content-section"></div>
        </div>
    </div>

    <div id="cartModal" class="modal">
        <span class="close-btn" onclick="closeModal('cartModal')">&times;</span>
        <div class="modal-body">
            <h2 style="text-align: center;">سلة التسوق</h2>
            <div id="cartItemsContainer">
                <p style="text-align: center; color: #ccc;">سلتك فارغة.</p>
            </div>
            <div class="discount-code-container">
                <input type="text" id="discountCodeInput" placeholder="كود الخصم">
                <button id="applyDiscountBtn" onclick="applyDiscount()">تطبيق</button>
            </div>
            <div id="discountMessage" class="discount-message"></div>
            <div id="cartTotalContainer" class="cart-modal-total">
                الإجمالي: <span id="cartTotalPrice">0</span> ج.م
            </div>
            <div class="modal-trust-badges">
                <div class="trust-badge">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                    <span>دفع آمن</span>
                </div>
                <div class="trust-badge">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                    <span>تسليم فوري</span>
                </div>
            </div>
            <button onclick="goToCheckout()" class="checkout-btn-centered">إتمام الشراء</button>
        </div>
    </div>

    <div id="checkoutModal" class="modal">
        <span class="close-btn" onclick="closeModal('checkoutModal')">&times;</span>
        <div class="modal-body">
            <h2 style="text-align: center;">طرق الدفع</h2>
            <p style="text-align: center; color: #ccc;">اختر طريقة الدفع المناسبة لك:</p>
            <div id="checkoutPaymentOptionsContainer">
            </div>
        </div>
    </div>

    <div id="supportModal" class="modal">
        <span class="close-btn" onclick="closeModal('supportModal')">&times;</span>
        <div class="modal-body">
            <h2>الدعم الفني</h2>
            <div class="support-form-container">
                <p>للتواصل معنا، يمكنك استخدام الإيميل:</p>
                <p><strong>Berlinstoregoe@gmail.com</strong></p>
            </div>
        </div>
    </div>
    <div id="overlay" class="overlay" onclick="closeModal('all')"></div>

    <footer id="footer">
        <div class="trust-badges-container">
            <div class="trust-badge">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                <span>دفع آمن 100%</span>
            </div>
            <div class="trust-badge">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                <span>تسليم فوري</span>
            </div>
            <div class="trust-badge">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                <span>دعم فني 24/7</span>
            </div>
        </div>
        <div class="footer-links">
            <a href="https://discord.gg/D3shcEb5xe" target="_blank" class="footer-link">
                <span>سيرفر الديسكورد</span>
                <img src="./images/discord.png" alt="Discord">
            </a>
            <a href="https://linktr.ee/Berlinstore22" target="_blank" class="footer-link">
                <span>جميع روابطنا</span>
                <img src="./images/BerlinStore.png" alt="Berlin Store Logo">
            </a>
            <a href="#about" class="footer-link">من نحن</a>
            <a href="#terms" class="footer-link">شروط الخدمة</a>
            <a href="#privacy" class="footer-link">سياسة الخصوصية</a>
        </div>
        <p id="copyright">© 2025 Berlin Store. جميع الحقوق محفوظة.</p>
    </footer>

    <script>
        // دالة لعرض قائمة تقييمات المتجر
        function renderStoreReviews() {
            const reviewsContainer = document.getElementById('store-reviews-list');
            const ratings = JSON.parse(localStorage.getItem('storeRatings')) || [];

            reviewsContainer.innerHTML = ''; // تفريغ الحاوية قبل إعادة العرض

            if (ratings.length === 0) {
                reviewsContainer.innerHTML = `<p style="text-align: center; color: #ccc;">لا توجد تقييمات لعرضها.</p>`;
                return;
            }

            ratings.forEach(review => {
                const reviewItem = document.createElement('div');
                reviewItem.className = 'comment-card'; // إعادة استخدام نفس تنسيق كارت التعليقات

                let starsHTML = '';
                for (let i = 1; i <= 5; i++) {
                    starsHTML += `<span class="star ${i <= review.rating ? 'filled' : ''}">★</span>`;
                }

                reviewItem.innerHTML = `
            <div class="comment-card-header">
                <span class="comment-author">${review.name}</span>
                <div class="comment-rating">${starsHTML}</div>
            </div>
            <p class="comment-text">${review.text}</p>
        `;
                reviewsContainer.appendChild(reviewItem);
            });
        }
        // دالة لحفظ وإرسال تقييم المتجر
        function submitStoreRating() {
            const nameInput = document.getElementById('rating-name');
            const textInput = document.getElementById('rating-text');
            const ratingInput = document.getElementById('storeRatingInput');
            const messageElement = document.getElementById('feedback-message');

            const name = nameInput.value;
            const text = textInput.value;
            const rating = parseInt(ratingInput.value);

            if (!name) {
                alert('الرجاء إدخال اسمك.');
                return;
            }
            if (rating === 0) {
                alert('الرجاء اختيار تقييم (من 1 إلى 5 نجوم).');
                return;
            }

            const newRating = {
                name: name,
                text: text || " ",
                rating: rating,
                date: new Date().toISOString()
            };

            // حفظ التقييمات في Local Storage
            let ratings = JSON.parse(localStorage.getItem('storeRatings')) || [];
            ratings.unshift(newRating); // إضافة التقييم الجديد في البداية
            localStorage.setItem('storeRatings', JSON.stringify(ratings));

            messageElement.textContent = "شكرًا لتقييمك! رأيك يهمنا.";
            messageElement.style.color = '#00ff00';

            // إعادة تحميل عرض التقييمات لتحديث المتوسط
            loadStoreRatings();

            // تفريغ الحقول
            nameInput.value = '';
            textInput.value = '';
            ratingInput.value = '0';
            document.getElementById('storeRatingStars').dataset.rating = '0';

            setTimeout(() => { messageElement.textContent = ''; }, 4000);
        }

        // دالة لجعل النجوم في فورم الإضافة تفاعلية
        function setupStoreRatingInput() {
            const starsContainer = document.getElementById('storeRatingStars');
            if (!starsContainer) return;

            const ratingInput = document.getElementById('storeRatingInput');
            const stars = starsContainer.querySelectorAll('.star');

            stars.forEach(star => {
                star.addEventListener('click', () => {
                    const value = star.dataset.value;
                    ratingInput.value = value;
                    starsContainer.dataset.rating = value;
                });
            });
        }

        // دالة لتحميل وعرض متوسط التقييمات
        function loadStoreRatings() {
            const displayContainer = document.getElementById('store-average-rating-display');
            const ratings = JSON.parse(localStorage.getItem('storeRatings')) || [];

            if (ratings.length === 0) {
                displayContainer.innerHTML = `<p class="summary-text">كن أول من يقيّم المتجر!</p>`;
                return;
            }

            const totalRating = ratings.reduce((sum, review) => sum + review.rating, 0);
            const averageRating = totalRating / ratings.length;
            const roundedAverage = Math.round(averageRating * 10) / 10; // تقريب لأقرب جزء من عشرة
            const starCount = Math.round(averageRating);

            let starsHTML = '';
            for (let i = 1; i <= 5; i++) {
                starsHTML += `<span class="star ${i <= starCount ? '' : 'empty'}">★</span>`;
            }

            displayContainer.innerHTML = `
        <div class="stars">${starsHTML}</div>
        <p class="summary-text">
            <strong>${roundedAverage}</strong> من 5 نجوم (بناءً على ${ratings.length} تقييم)
        </p>
    `;
        }
        function performGlobalSearch(query) {
            // 1. الانتقال إلى صفحة نتائج البحث
            window.location.hash = '#searchResults';

            const searchTerm = query.toLowerCase().trim();
            const resultsContainer = document.getElementById('searchResultsContainer');
            const resultsTitle = document.getElementById('searchResultsTitle');
            const noResultsMsg = document.getElementById('noResultsMessage');

            // 2. تحديث عنوان الصفحة وتجهيزها
            resultsTitle.textContent = `نتائج البحث عن: "${query}"`;
            resultsContainer.innerHTML = '';
            noResultsMsg.style.display = 'none';

            let resultsFound = 0;

            // 3. البحث في كامل قائمة المنتجات (productsData)
            for (const productId in productsData) {
                const product = productsData[productId];
                const productTitle = product.title.toLowerCase();
                // السطر التالي هو الذي تم تعديله
                const productDescription = (product.shortDescription || '').toLowerCase();

                if (productTitle.includes(searchTerm) || productDescription.includes(searchTerm)) {
                    // 4. إذا تم العثور على نتيجة، قم بعرضها
                    renderProductItem(product, resultsContainer, 'search', true);
                    resultsFound++;
                }
            }

            // 5. في حالة عدم وجود أي نتائج
            if (resultsFound === 0) {
                noResultsMsg.style.display = 'block';
            }
        }
        const productsData = {
            "splitfiction_rent": {
                id: "splitfiction_rent",
                title: "Split Fiction (إيجار)",
                image: "./images/split.png",
                shortDescription: "حساب ستيم إيجار للعبة Split Fiction.",
                fullDescription: "احصل على حساب ستيم بإيجار للعبة Split Fiction. الخيار الأفضل لتجربة اللعبة بالكامل دون الحاجة للشراء الدائم.",
                platform: 'steam',
                isRentable: true,
                options: {
                    "two_weeks": { title: "أسبوعين", price: 99 },
                    "one_month": { title: "شهر", price: 140 },
                    "two_months": { title: "شهرين", price: 190 }
                }
            },
            "gta": {
                id: "gta",
                title: "حساب GTA 5 Steam",
                price: 750,
                image: "./images/GTA5Banner.png",
                shortDescription: "ابدأ رحلتك في لوس سانتوس",
                fullDescription: "انغمس في عالم لوس سانتوس المترامي الأطراف! عش حياة الجريمة والمغامرات التي لا تنتهي مع ثلاثة شخصيات فريدة. نفّذ عمليات سطو جريئة، تسابق في شوارع المدينة، أو استكشف عالم GTA Online المليء باللاعبين والتحديات. هذا الحساب يمنحك صلاحيات كاملة على <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong> لتصنع أسطورتك الخاصة في عالم GTA 5.",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Grand Theft Auto V</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 8.1 64 Bit, Windows 8 64 Bit, Windows 7 64 Bit Service Pack 1</li>
            <li><strong>المعالج:</strong> Intel Core 2 Quad CPU Q6600 @ 2.40GHz (4 CPUs) / AMD Phenom 9850 Quad-Core Processor (4 CPUs) @ 2.5GHz</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> NVIDIA 9800 GT 1GB / AMD HD 4870 1GB (DX 10, 10.1, 11)</li>
            <li><strong>مساحة تخزين:</strong> 72 GB</li>
        </ul>
        <hr>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10 64 Bit</li>
            <li><strong>المعالج:</strong> Intel Core i5 3470 @ 3.2GHz (4 CPUs) / AMD X8 FX-8350 @ 4GHz (8 CPUs)</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> NVIDIA GTX 660 2GB / AMD HD 7870 2GB</li>
            <li><strong>مساحة تخزين:</strong> 72 GB</li>
        </ul>`
            },
            "minecraft": {
                id: "minecraft",
                title: "حساب Minecraft",
                price: 340,
                image: "./images/minecraft.png",
                shortDescription: "أطلق العنان لإبداعك",
                fullDescription: "أطلق العنان لإبداعك في عالم لا نهائي من المكعبات! ابنِ قلاعاً شامخة، استكشف كهوفاً غامضة، وحارب الوحوش في الليل. سواء كنت تفضل البقاء على قيد الحياة بمفردك أو التعاون مع أصدقائك، فإن هذا الحساب الرسمي من <img src='./images/microsoft.png' class='platform-icon-description' alt='Microsoft Icon'> <strong>Microsoft</strong> يمنحك صلاحيات كاملة لتشكيل عالمك كما تتخيل. المغامرة تنتظرك في كل زاوية!",
                platform: 'microsoft',
                stock: 3,
                specs: `<h3>متطلبات تشغيل Minecraft: Java Edition</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7 والإصدارات الأحدث</li>
            <li><strong>المعالج:</strong> Intel Core i3-3210 3.2 GHz / AMD A8-7600 APU 3.1 GHz أو ما يعادله</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD Graphics 4000 (Ivy Bridge) or AMD Radeon R5 series (Kaveri line) with OpenGL 4.4</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>
        <hr>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10 64-bit</li>
            <li><strong>المعالج:</strong> Intel Core i5-4690 3.5GHz / AMD A10-7800 APU 3.5 GHz أو ما يعادله</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> GeForce 700 Series or AMD Radeon Rx 200 Series (excluding integrated chipsets) with OpenGL 4.5</li>
            <li><strong>مساحة تخزين:</strong> 4 GB (SSD موصى به)</li>
        </ul>`
            },
            "residentevil_offline": {
                id: "residentevil_offline",
                title: "Resident Evil 8: Village",
                price: 150,
                image: "./images/residentevil8.png",
                shortDescription: "حساب أوفلاين للعبة Resident Evil 8",
                fullDescription: "جرب قصة رعب البقاء على قيد الحياة النهائية في Resident Evil Village، الجزء الثامن من سلسلة Resident Evil. مع رسومات مفصلة للغاية، وأكشن عنيف من منظور الشخص الأول، وقصة بارعة، لم يكن الرعب أكثر واقعية من قبل.",
                platform: 'steam',
                badges: ['OFFLINE'],
                specs: `<h3>متطلبات تشغيل Resident Evil Village</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10 (64-bit)</li>
            <li><strong>المعالج:</strong> Intel Core i5-7500 / AMD Ryzen 3 1200</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> NVIDIA GeForce GTX 1050 Ti with 4GB VRAM / AMD Radeon RX 560 with 4GB VRAM</li>
            <li><strong>مساحة تخزين:</strong> 25 GB</li>
        </ul>`
            },
            "splitfiction": {
                id: "splitfiction",
                title: "حساب Split Fiction",
                price: 99,
                image: "./images/split.png",
                shortDescription: "استأجر اللعبة لمدة أسبوعين",
                fullDescription: "هل أنت مستعد لتجربة قصة فريدة من نوعها؟ Split Fiction تقدم لك مغامرة سينمائية لا مثيل لها. استأجر اللعبة الآن لمدة أسبوعين، وهي فترة مثالية لإنهاء القصة المذهلة والاستمتاع بكل لحظاتها المشوقة دون الحاجة لشراء اللعبة كاملة. فرصة لا تعوض لتجربة واحدة من أروع الألعاب! <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<p>لا توجد مواصفات رسمية لهذه اللعبة بعد.</p>`
            },
            "mafia": {
                id: "mafia",
                title: "Mafia: The Old Country",
                price: 49,
                image: "./images/mafia.png",
                shortDescription: "ابنِ إمبراطوريتك الإجرامية",
                fullDescription: "عد بالزمن إلى العصر الذهبي للمافيا. في Mafia: The Old Country، كل قرار قد يكلفك حياتك. ابنِ إمبراطوريتك الإجرامية، وتسلق المراتب في عالم لا يرحم من الولاء والخيانة. هل لديك ما يلزم لتصبح الزعيم؟ عش القصة الملحمية المليئة بالدراما والأكشن الذي يحبس الأنفاس. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<p>لا توجد مواصفات رسمية لهذه اللعبة بعد.</p>`
            },
            "rust": {
                id: "rust",
                title: "Rust",
                price: 220,
                image: "./images/Rust.png",
                shortDescription: "الهدف هو البقاء على قيد الحياة",
                fullDescription: "الهدف الوحيد في Rust هو البقاء على قيد الحياة. تغلب على الصراعات مثل الجوع والعطش والبرد. قم ببناء نار. قم ببناء مأوى. اقتل الحيوانات من أجل اللحم. احم نفسك من اللاعبين الآخرين، واقتلهم من أجل اللحم. قم بإنشاء تحالفات مع لاعبين آخرين وشكل مدينة. افعل كل ما يتطلبه الأمر للبقاء على قيد الحياة. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Rust</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 8.1 64bit</li>
            <li><strong>المعالج:</strong> Intel Core i7-3770 / AMD FX-9590 أو أفضل</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 10 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> GTX 670 2GB / AMD R9 280 أو أفضل</li>
            <li><strong>مساحة تخزين:</strong> 25 GB (SSD موصى به)</li>
        </ul>
        <hr>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 11 64bit</li>
            <li><strong>المعالج:</strong> Intel Core i7-4790K / AMD Ryzen 5 1600 أو أفضل</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 16 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> GTX 980 / AMD R9 Fury أو أفضل</li>
            <li><strong>مساحة تخزين:</strong> 25 GB (SSD موصى به)</li>
        </ul>`
            },
            "wallpaperEngine": {
                id: "wallpaperEngine",
                title: "Wallpaper Engine",
                price: 90,
                image: "./images/we.png",
                shortDescription: "خلفيات متحركة لسطح المكتب",
                fullDescription: "حوّل سطح مكتبك إلى تحفة فنية متحركة. استخدم خلفيات فيديو، أو تطبيقات تفاعلية، أو حتى مواقع ويب كخلفية لك. يدعم Wallpaper Engine جميع أنواع الشاشات ويوفر أداءً ممتازًا. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Wallpaper Engine</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7 (with Aero), 8.1, 10, 11</li>
            <li><strong>المعالج:</strong> 1.66 GHz Intel i5 or equivalent</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 1024 MB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> HD Graphics 4000 or above</li>
            <li><strong>مساحة تخزين:</strong> 512 MB</li>
        </ul>`
            },
            "hollowknight": {
                id: "hollowknight",
                title: "Hollow Knight: Silksong",
                price: 399,
                image: "./images/hollowknight.png",
                shortDescription: "مغامرة جديدة في مملكة Hallownest",
                fullDescription: "انطلق في مغامرة جديدة مع Hornet في لعبة Hollow Knight: Silksong. استكشف مملكة جديدة، وقابل شخصيات فريدة، وحارب أعداء أقوياء في طريقك. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<p>لا توجد مواصفات رسمية لهذه اللعبة بعد.</p>`
            },
            "seaofthieves": {
                id: "seaofthieves",
                title: "حساب لعبة Sea of Thieves",
                price: 350,
                image: "./images/sot.png",
                shortDescription: "كن قرصانًا حقيقيًا",
                fullDescription: "انطلق في مغامرات بحرية، ابحث عن الكنوز المفقودة، وحارب قراصنة آخرين في عالم Sea of Thieves الواسع. استمتع بتجربة القراصنة النهائية. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Sea of Thieves</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10</li>
            <li><strong>المعالج:</strong> Intel Core i5-4690 أو AMD FX-8150</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Nvidia GeForce GTX 770 أو AMD Radeon R9 380x</li>
            <li><strong>مساحة تخزين:</strong> 50 GB</li>
        </ul>`
            },
            "rdr2": {
                id: "rdr2",
                title: "حساب Red Dead Redemption 2",
                price: 850,
                image: "./images/rdr2.png",
                shortDescription: "أفضل لعبة في الغرب المتوحش",
                fullDescription: "انغمس في قصة آرثر مورغان وعصابة فان دير ليند في ملحمة الغرب المتوحش. استكشف عالمًا مفتوحًا ضخمًا وشارك في مغامرات لا تُنسى. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Red Dead Redemption 2</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7 Service Pack 1 (6.1.7601)</li>
            <li><strong>المعالج:</strong> Intel Core i5-2500K / AMD FX-6300</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Nvidia GeForce GTX 770 2GB / AMD Radeon R9 280 3GB</li>
            <li><strong>مساحة تخزين:</strong> 150 GB</li>
        </ul>`
            },
            "eldenring": {
                id: "eldenring",
                title: "حساب Elden Ring",
                price: 650,
                image: "./images/elden.png",
                shortDescription: "اكتشف عالم الأراضي الوسطى",
                fullDescription: "اكتشف عالمًا خياليًا جديدًا من تأليف Hidetaka Miyazaki و George R. R. Martin. انطلق في رحلة ملحمية لاستعادة قوة Elden Ring. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Elden Ring</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10</li>
            <li><strong>المعالج:</strong> Intel Core i5-8400 أو AMD Ryzen 3 3300X</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 12 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Nvidia GeForce GTX 1060 3GB أو AMD Radeon RX 580 4GB</li>
            <li><strong>مساحة تخزين:</strong> 60 GB</li>
        </ul>`

            },
            "residentevil_offline": {
                id: "residentevil_offline",
                title: "Resident Evil 8: Village",
                price: 150,
                image: "./images/residentevil8.png",
                shortDescription: "حساب أوفلاين للعبة Resident Evil 8",
                fullDescription: "جرب قصة رعب البقاء على قيد الحياة النهائية في Resident Evil Village، الجزء الثامن من سلسلة Resident Evil. مع رسومات مفصلة للغاية، وأكشن عنيف من منظور الشخص الأول، وقصة بارعة، لم يكن الرعب أكثر واقعية من قبل.",
                platform: 'steam',
                badges: ['OFFLINE'],
                specs: `<h3>متطلبات تشغيل Resident Evil Village</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10 (64-bit)</li>
            <li><strong>المعالج:</strong> Intel Core i5-7500 / AMD Ryzen 3 1200</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> NVIDIA GeForce GTX 1050 Ti with 4GB VRAM / AMD Radeon RX 560 with 4GB VRAM</li>
            <li><strong>مساحة تخزين:</strong> 25 GB</li>
        </ul>`
            },
            "splitfiction": {
                id: "splitfiction",
                title: "حساب Split Fiction",
                price: 99,
                image: "./images/split.png",
                shortDescription: "استأجر اللعبة لمدة أسبوعين",
                fullDescription: "هل أنت مستعد لتجربة قصة فريدة من نوعها؟ Split Fiction تقدم لك مغامرة سينمائية لا مثيل لها. استأجر اللعبة الآن لمدة أسبوعين، وهي فترة مثالية لإنهاء القصة المذهلة والاستمتاع بكل لحظاتها المشوقة دون الحاجة لشراء اللعبة كاملة. فرصة لا تعوض لتجربة واحدة من أروع الألعاب! <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<p>لا توجد مواصفات رسمية لهذه اللعبة بعد.</p>`
            },
            "mafia": {
                id: "mafia",
                title: "Mafia: The Old Country",
                price: 49,
                image: "./images/mafia.png",
                shortDescription: "ابنِ إمبراطوريتك الإجرامية",
                fullDescription: "عد بالزمن إلى العصر الذهبي للمافيا. في Mafia: The Old Country، كل قرار قد يكلفك حياتك. ابنِ إمبراطوريتك الإجرامية، وتسلق المراتب في عالم لا يرحم من الولاء والخيانة. هل لديك ما يلزم لتصبح الزعيم؟ عش القصة الملحمية المليئة بالدراما والأكشن الذي يحبس الأنفاس. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<p>لا توجد مواصفات رسمية لهذه اللعبة بعد.</p>`
            },
            "rust": {
                id: "rust",
                title: "Rust",
                price: 220,
                image: "./images/Rust.png",
                shortDescription: "الهدف هو البقاء على قيد الحياة",
                fullDescription: "الهدف الوحيد في Rust هو البقاء على قيد الحياة. تغلب على الصراعات مثل الجوع والعطش والبرد. قم ببناء نار. قم ببناء مأوى. اقتل الحيوانات من أجل اللحم. احم نفسك من اللاعبين الآخرين، واقتلهم من أجل اللحم. قم بإنشاء تحالفات مع لاعبين آخرين وشكل مدينة. افعل كل ما يتطلبه الأمر للبقاء على قيد الحياة. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Rust</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 8.1 64bit</li>
            <li><strong>المعالج:</strong> Intel Core i7-3770 / AMD FX-9590 أو أفضل</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 10 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> GTX 670 2GB / AMD R9 280 أو أفضل</li>
            <li><strong>مساحة تخزين:</strong> 25 GB (SSD موصى به)</li>
        </ul>
        <hr>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 11 64bit</li>
            <li><strong>المعالج:</strong> Intel Core i7-4790K / AMD Ryzen 5 1600 أو أفضل</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 16 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> GTX 980 / AMD R9 Fury أو أفضل</li>
            <li><strong>مساحة تخزين:</strong> 25 GB (SSD موصى به)</li>
        </ul>`
            },
            "wallpaperEngine": {
                id: "wallpaperEngine",
                title: "Wallpaper Engine",
                price: 90,
                image: "./images/we.png",
                shortDescription: "خلفيات متحركة لسطح المكتب",
                fullDescription: "حوّل سطح مكتبك إلى تحفة فنية متحركة. استخدم خلفيات فيديو، أو تطبيقات تفاعلية، أو حتى مواقع ويب كخلفية لك. يدعم Wallpaper Engine جميع أنواع الشاشات ويوفر أداءً ممتازًا. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Wallpaper Engine</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7 (with Aero), 8.1, 10, 11</li>
            <li><strong>المعالج:</strong> 1.66 GHz Intel i5 or equivalent</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 1024 MB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> HD Graphics 4000 or above</li>
            <li><strong>مساحة تخزين:</strong> 512 MB</li>
        </ul>`
            },
            "hollowknight": {
                id: "hollowknight",
                title: "Hollow Knight: Silksong",
                price: 399,
                image: "./images/hollowknight.png",
                shortDescription: "مغامرة جديدة في مملكة Hallownest",
                fullDescription: "انطلق في مغامرة جديدة مع Hornet في لعبة Hollow Knight: Silksong. استكشف مملكة جديدة، وقابل شخصيات فريدة، وحارب أعداء أقوياء في طريقك. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<p>لا توجد مواصفات رسمية لهذه اللعبة بعد.</p>`
            },
            "seaofthieves": {
                id: "seaofthieves",
                title: "حساب لعبة Sea of Thieves",
                price: 350,
                image: "./images/sot.png",
                shortDescription: "كن قرصانًا حقيقيًا",
                fullDescription: "انطلق في مغامرات بحرية، ابحث عن الكنوز المفقودة، وحارب قراصنة آخرين في عالم Sea of Thieves الواسع. استمتع بتجربة القراصنة النهائية. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Sea of Thieves</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10</li>
            <li><strong>المعالج:</strong> Intel Core i5-4690 أو AMD FX-8150</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Nvidia GeForce GTX 770 أو AMD Radeon R9 380x</li>
            <li><strong>مساحة تخزين:</strong> 50 GB</li>
        </ul>`
            },
            "rdr2": {
                id: "rdr2",
                title: "حساب Red Dead Redemption 2",
                price: 850,
                image: "./images/rdr2.png",
                shortDescription: "أفضل لعبة في الغرب المتوحش",
                fullDescription: "انغمس في قصة آرثر مورغان وعصابة فان دير ليند في ملحمة الغرب المتوحش. استكشف عالمًا مفتوحًا ضخمًا وشارك في مغامرات لا تُنسى. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Red Dead Redemption 2</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7 Service Pack 1 (6.1.7601)</li>
            <li><strong>المعالج:</strong> Intel Core i5-2500K / AMD FX-6300</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 8 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Nvidia GeForce GTX 770 2GB / AMD Radeon R9 280 3GB</li>
            <li><strong>مساحة تخزين:</strong> 150 GB</li>
        </ul>`
            },
            "eldenring": {
                id: "eldenring",
                title: "حساب Elden Ring",
                price: 650,
                image: "./images/elden.png",
                shortDescription: "اكتشف عالم الأراضي الوسطى",
                fullDescription: "اكتشف عالمًا خياليًا جديدًا من تأليف Hidetaka Miyazaki و George R. R. Martin. انطلق في رحلة ملحمية لاستعادة قوة Elden Ring. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam',
                specs: `<h3>متطلبات تشغيل Elden Ring</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 10</li>
            <li><strong>المعالج:</strong> Intel Core i5-8400 أو AMD Ryzen 3 3300X</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 12 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Nvidia GeForce GTX 1060 3GB أو AMD Radeon RX 580 4GB</li>
            <li><strong>مساحة تخزين:</strong> 60 GB</li>
        </ul>`

            },

            // ============== منتجات إهداء ألعاب ستيم - بداية ==============
            "gta_gift": {
                id: "gta_gift",
                title: "إهداء لعبة GTA 5",
                price: 1635,
                image: "./images/GTA5Banner.png",
                shortDescription: "أرسل النسخة الكاملة من GTA 5 كهدية",
                fullDescription: "أرسل النسخة الكاملة من GTA 5 كهدية",
                platform: 'steam',
                requiresSteamFriendCode: true
            },
            "rust_gift": {
                id: "rust_gift",
                title: "إهداء لعبة Rust",
                price: 2185,
                image: "./images/Rust.png",
                shortDescription: "أرسل لعبة البقاء الشهيرة Rust كهدية",
                fullDescription: "أرسل لعبة البقاء الشهيرة Rust كهدية",
                platform: 'steam',
                requiresSteamFriendCode: true
            },
            "seaofthieves_gift": {
                id: "seaofthieves_gift",
                title: "إهداء لعبة Sea of Thieves",
                price: 2185,
                image: "./images/sot.png",
                shortDescription: "أرسل مغامرة القراصنة Sea of Thieves كهدية",
                fullDescription: "أرسل مغامرة القراصنة Sea of Thieves كهدية",
                platform: 'steam',
                requiresSteamFriendCode: true
            },
            "rdr2_gift": {
                id: "rdr2_gift",
                title: "إهداء لعبة Red Dead 2",
                price: 3275,
                image: "./images/rdr2.png",
                shortDescription: "أرسل تحفة روكستار الفنية RDR 2 كهدية",
                fullDescription: "أرسل تحفة روكستار الفنية RDR 2 كهدية",
                platform: 'steam',
                requiresSteamFriendCode: true
            },
            "eldenring_gift": {
                id: "eldenring_gift",
                title: "إهداء لعبة Elden Ring",
                price: 3275,
                image: "./images/elden.png",
                shortDescription: "أرسل لعبة العام Elden Ring كهدية",
                fullDescription: "أرسل لعبة العام Elden Ring كهدية",
                platform: 'steam',
                requiresSteamFriendCode: true
            },
            "wallpaperEngine_gift": {
                id: "wallpaperEngine_gift",
                title: "إهداء برنامج Wallpaper Engine",
                price: 220,
                image: "./images/we.png",
                shortDescription: "أرسل برنامج الخلفيات المتحركة كهدية",
                fullDescription: "أرسل برنامج الخلفيات المتحركة كهدية",
                platform: 'steam',
                requiresSteamFriendCode: true
            },
            // ============== منتجات إهداء ألعاب ستيم - نهاية ==============
            "netflix": {
                id: "netflix",
                title: "اشتراك نتفليكس",
                // السعر الأساسي الآن هو سعر أول خيار
                price: 50,
                image: "./images/netflix.png",
                shortDescription: "شاهد آلاف الأفلام والمسلسلات",
                fullDescription: "استمتع بوصول غير محدود إلى مكتبة ضخمة من الأفلام والمسلسلات والبرامج الوثائقية الأصلية من Netflix. شاهد على أي جهاز، في أي وقت، وبأعلى جودة ممكنة.",
                options: {
                    "1_month": { title: "شهر واحد", price: 50 },
                    "2_months": { title: "شهرين", price: 90 },
                    "3_months": { title: "3 شهور", price: 135 },
                    "6_months": { title: "6 شهور", price: 270 } // تمت الإضافة هنا
                }
            },
            "disney": {
                id: "disney",
                title: "اشتراك ديزني بلس",
                price: 39,
                image: "./images/disney.png",
                shortDescription: "عالم من الترفيه لكل العائلة",
                fullDescription: "عالم من الترفيه من Disney, Pixar, Marvel, Star Wars, و National Geographic. احصل على أحدث الإصدارات، والكلاسيكيات الخالدة، والأعمال الأصلية الحصرية، كل ذلك في مكان واحد.",
                options: {
                    "1_month": { title: "شهر واحد", price: 39 },
                    "2_months": { title: "شهرين", price: 75 },
                    "3_months": { title: "3 شهور", price: 105 } // تم التعديل هنا
                }
            },
            "crunchyroll": {
                id: "crunchyroll",
                title: "اشتراك كرانشي رول",
                price: 50,
                image: "./images/crunshyyyy.png",
                shortDescription: "أكبر مكتبة للأنمي في العالم",
                fullDescription: "أكبر مكتبة للأنمي في العالم. شاهد أحدث الحلقات بعد ساعة من بثها في اليابان. استمتع بآلاف الحلقات من مسلسلاتك المفضلة بدون إعلانات وبجودة عالية.",
                options: {
                    "1_month": { title: "شهر واحد", price: 50 },
                    "2_months": { title: "شهرين", price: 90 },
                    "3_months": { title: "3 شهور", price: 110 } // تم التعديل هنا
                }
            },
            "gamepass": {
                id: "gamepass",
                title: "اشتراك Game Pass Ultimate",
                price: 220,
                image: "./images/Xbox.png",
                shortDescription: "مئات الألعاب عالية الجودة",
                fullDescription: "احصل على وصول غير محدود إلى مكتبة ضخمة تضم مئات الألعاب عالية الجودة على الكونسول والكمبيوتر الشخصي. استمتع بكل حصريات Xbox من اليوم الأول للإصدار، بالإضافة إلى اشتراك EA Play بدون تكلفة إضافية.",
                platform: 'microsoft',
                options: {
                    "1_month": { title: "شهر واحد", price: 220 }
                }
            },
            "valorant475": {
                id: "valorant475",
                title: "475 Valorant Points",
                price: 270,
                image: "./images/reyna.png",
                shortDescription: "شحن 475 نقطة فالورانت",
                fullDescription: "اشحن حسابك في لعبة فالورانت بـ 475 نقطة. استخدمها لشراء سكنات الأسلحة، Battle Pass، أو أي عناصر تجميلية أخرى داخل اللعبة.",
                platform: 'riot',
                specs: `<h3>متطلبات تشغيل VALORANT</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7/8/10 64-Bit</li>
            <li><strong>المعالج:</strong> Intel Core 2 Duo E8400 / AMD Athlon 200GE</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD 4000 / Radeon R5 200</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>`
            },
            "valorant1000": {
                id: "valorant1000",
                title: "1000 Valorant Points",
                price: 510,
                image: "./images/reyna.png",
                shortDescription: "شحن 1000 نقطة فالورانت",
                fullDescription: "عزز تجربتك في فالورانت بـ 1000 نقطة. هذه الباقة تمنحك المرونة الكافية للحصول على العناصر التي ترغب بها داخل اللعبة.",
                platform: 'riot',
                specs: `<h3>متطلبات تشغيل VALORANT</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7/8/10 64-Bit</li>
            <li><strong>المعالج:</strong> Intel Core 2 Duo E8400 / AMD Athlon 200GE</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD 4000 / Radeon R5 200</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>`
            },
            "valorant2050": {
                id: "valorant2050",
                title: "2050 Valorant Points",
                price: 990,
                image: "./images/reyna.png",
                shortDescription: "شحن 2050 نقطة فالورانت",
                fullDescription: "احصل على 2050 نقطة فالورانت لتتمكن من شراء حزم السكنات المميزة أو تجهيز شخصياتك بأفضل الإضافات التجميلية.",
                platform: 'riot',
                specs: `<h3>متطلبات تشغيل VALORANT</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7/8/10 64-Bit</li>
            <li><strong>المعالج:</strong> Intel Core 2 Duo E8400 / AMD Athlon 200GE</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD 4000 / Radeon R5 200</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>`
            },
            "valorant3650": {
                id: "valorant3650",
                title: "3650 Valorant Points",
                price: 1730,
                image: "./images/reyna.png",
                shortDescription: "شحن 3650 نقطة فالورانت",
                fullDescription: "باقة كبيرة من نقاط فالورانت تتيح لك حرية واسعة في الاختيار من بين أفضل العناصر والمجموعات الحصرية داخل اللعبة.",
                platform: 'riot',
                specs: `<h3>متطلبات تشغيل VALORANT</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7/8/10 64-Bit</li>
            <li><strong>المعالج:</strong> Intel Core 2 Duo E8400 / AMD Athlon 200GE</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD 4000 / Radeon R5 200</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>`
            },
            "valorant5350": {
                id: "valorant5350",
                title: "5350 Valorant Points",
                price: 2430,
                image: "./images/reyna.png",
                shortDescription: "شحن 5350 نقطة فالورانت",
                fullDescription: "وفر أكثر مع باقة 5350 نقطة. هذه هي فرصتك للحصول على كل ما تحلم به في فالورانت من سكنات نادرة وعناصر مميزة.",
                platform: 'riot',
                specs: `<h3>متطلبات تشغيل VALORANT</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7/8/10 64-Bit</li>
            <li><strong>المعالج:</strong> Intel Core 2 Duo E8400 / AMD Athlon 200GE</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD 4000 / Radeon R5 200</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>`
            },
            "valorant11000": {
                id: "valorant11000",
                title: "11000 Valorant Points",
                price: 4880,
                image: "./images/reyna.png",
                shortDescription: "شحن 11000 نقطة فالورانت",
                fullDescription: "الباقة الأكبر والأكثر توفيراً! 11000 نقطة تضمن لك الحصول على أندر المجموعات والعناصر داخل اللعبة لتتميز عن الجميع.",
                platform: 'riot',
                specs: `<h3>متطلبات تشغيل VALORANT</h3>
        <ul>
            <li><strong>نظام التشغيل:</strong> Windows 7/8/10 64-Bit</li>
            <li><strong>المعالج:</strong> Intel Core 2 Duo E8400 / AMD Athlon 200GE</li>
            <li><strong>الذاكرة العشوائية (RAM):</strong> 4 GB</li>
            <li><strong>بطاقة الرسومات (GPU):</strong> Intel HD 4000 / Radeon R5 200</li>
            <li><strong>مساحة تخزين:</strong> 1 GB</li>
        </ul>`
            },
            "steam20k": {
                id: "steam20k",
                title: "20 ألف Steam Points",
                price: 255,
                image: "./images/steam.png",
                shortDescription: "لتخصيص بروفايلك بالكامل",
                fullDescription: "استخدم 20,000 نقطة لشراء خلفيات، أيقونات، وتخصيصات فريدة لتميز نفسك بين اللاعبين. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "steam50k": {
                id: "steam50k",
                title: "50 ألف Steam Points",
                price: 490,
                image: "./images/steam.png",
                shortDescription: "باقة 50,000 نقطة لحسابك",
                fullDescription: "باقة 50,000 نقطة تمنحك حرية أكبر في تزيين وتخصيص حسابك على ستيم بكل ما هو مميز. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "steamGift5": {
                id: "steamGift5",
                title: "بطاقة هدايا ستيم 5$",
                price: 275,
                image: "./images/steam.png",
                shortDescription: "اشحن محفظتك بـ 5 دولارات",
                fullDescription: "اشحن محفظة ستيم الخاصة بك بـ 5 دولارات! هذه البطاقة العالمية تتيح لك شراء الألعاب، الإضافات، والعناصر من متجر ستيم بسهولة وأمان. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "steamGift10": {
                id: "steamGift10",
                title: "بطاقة هدايا ستيم 10$",
                price: 550,
                image: "./images/steam.png",
                shortDescription: "أضف 10 دولارات لرصيدك",
                fullDescription: "أضف 10 دولارات إلى رصيدك في ستيم! هدية مثالية لنفسك أو لصديق، تفتح لك عالمًا من الألعاب الرائعة على منصة ستيم. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "steamGift20": {
                id: "steamGift20",
                title: "بطاقة هدايا ستيم 20$",
                price: 1100,
                image: "./images/steam.png",
                shortDescription: "عزز مكتبة ألعابك الآن",
                fullDescription: "عزز مكتبة ألعابك! مع بطاقة 20 دولار، يمكنك الحصول على أحدث الألعاب أو الإضافات التي طالما رغبت بها. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "steamGift50": {
                id: "steamGift50",
                title: "بطاقة هدايا ستيم 50$",
                price: 2750,
                image: "./images/steam.png",
                shortDescription: "باقة سخية لعشاق الألعاب",
                fullDescription: "باقة سخية لعشاق الألعاب! 50 دولارًا في محفظة ستيم تمنحك القدرة على شراء عدة ألعاب ضخمة أو الاستثمار في العناصر داخل اللعبة. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "steamGift100": {
                id: "steamGift100",
                title: "بطاقة هدايا ستيم 100$",
                price: 5500,
                image: "./images/steam.png",
                shortDescription: "الهدية المثالية لأي لاعب",
                fullDescription: "الهدية المثالية لأي لاعب! بطاقة 100 دولار تضمن لك الحصول على أي لعبة تريدها، والمشاركة في التخفيضات الكبرى دون تردد. <br><br><strong>المنصة:</strong> <img src='./images/steam.png' class='platform-icon-description' alt='Steam Icon'> <strong>Steam</strong>",
                platform: 'steam'
            },
            "roblox40": {
                id: "roblox40",
                title: "40 Robux",
                price: 40,
                image: "./images/roblox.png",
                shortDescription: "شحن 40 روبوكس",
                fullDescription: "احصل على 40 روبوكس لتخصيص شخصيتك وشراء عناصر مميزة داخل عالم Roblox.",
                platform: 'roblox'
            },
            "roblox80": {
                id: "roblox80",
                title: "80 Robux",
                price: 80,
                image: "./images/roblox.png",
                shortDescription: "شحن 80 روبوكس",
                fullDescription: "ضاعف المرح مع 80 روبوكس. باقة مثالية للبدء في تجميع العناصر الرائعة.",
                platform: 'roblox'
            },
            "roblox400": {
                id: "roblox400",
                title: "400 Robux",
                price: 310,
                image: "./images/roblox.png",
                shortDescription: "شحن 400 روبوكس",
                fullDescription: "باقة رائعة تمنحك 400 روبوكس لاستكشاف المزيد من الإمكانيات وشراء أفضل الإضافات.",
                platform: 'roblox'
            },
            "roblox800": {
                id: "roblox800",
                title: "800 Robux",
                price: 599,
                image: "./images/roblox.png",
                shortDescription: "شحن 800 روبوكس",
                fullDescription: "عزز تجربتك في Roblox مع 800 روبوكس. اشترِ Game Passes أو خصص شخصيتك بأفضل الملابس.",
                platform: 'roblox'
            },
            "roblox800_discount": {
                id: "roblox800_discount",
                title: "800 Robux",
                price: 599,
                image: "./images/roblox.png",
                shortDescription: "شحن 800 روبوكس (عرض خاص)",
                fullDescription: "عرض خاص! احصل على 800 روبوكس بسعر مميز لفترة محدودة.",
                platform: 'roblox',
                badges: ['DISCOUNT']
            },
            "roblox1700": {
                id: "roblox1700",
                title: "1700 Robux",
                price: 1300,
                image: "./images/roblox.png",
                shortDescription: "شحن 1700 روبوكس",
                fullDescription: "باقة كبيرة من الروبوكس تفتح لك أبوابًا واسعة من التخصيصات والعناصر النادرة.",
                platform: 'roblox'
            },
            "roblox4700": {
                id: "roblox4700",
                title: "4700 Robux",
                price: 1300,
                image: "./images/roblox.png",
                shortDescription: "شحن 4700 روبوكس",
                fullDescription: "قيمة هائلة! احصل على 4700 روبوكس لتكون جاهزًا لأي شيء في عالم Roblox.",
                platform: 'roblox'
            },
            "roblox4500": {
                id: "roblox4500",
                title: "4500 Robux",
                price: 3000,
                image: "./images/roblox.png",
                shortDescription: "شحن 4500 روبوكس",
                fullDescription: "واحدة من أكبر الباقات! 4500 روبوكس تضمن لك الحصول على أندر العناصر وأفضل الميزات.",
                platform: 'roblox'
            },
            "fortnite1000": {
                id: "fortnite1000",
                title: "1000 V-Bucks",
                price: 360,
                image: "./images/fortnite.png",
                shortDescription: "شحن 1000 V-Bucks",
                fullDescription: "احصل على 1000 V-Bucks لاستخدامها في Fortnite. يمكنك شراء عناصر تخصيص جديدة مثل الأزياء، والطائرات الشراعية، والفؤوس، والرقصات، ومغلفات الأسلحة بالإضافة إلى Battle Pass للموسم الجديد!",
                platform: 'epic'
            },
            "fortnite2800": {
                id: "fortnite2800",
                title: "2800 V-Bucks",
                price: 820,
                image: "./images/fortnite.png",
                shortDescription: "شحن 2800 V-Bucks",
                fullDescription: "عزز تجربتك مع 2800 V-Bucks. باقة رائعة للحصول على Battle Pass والعديد من العناصر المميزة من متجر فورتنايت.",
                platform: 'epic'
            },
            "fortnite5000": {
                id: "fortnite5000",
                title: "5000 V-Bucks",
                price: 1350,
                image: "./images/fortnite.png",
                shortDescription: "شحن 5000 V-Bucks",
                fullDescription: "باقة كبيرة تمنحك 5000 V-Bucks. كن مستعدًا لشراء أندر الأزياء والحزم التي يصدرها متجر فورتنايت.",
                platform: 'epic'
            },
            "fortnite13500": {
                id: "fortnite13500",
                title: "13500 V-Bucks",
                price: 2950,
                image: "./images/fortnite.png",
                shortDescription: "شحن 13500 V-Bucks",
                fullDescription: "أكبر قيمة! احصل على 13500 V-Bucks لتضمن أنك لن تفوت أي عنصر حصري أو زي نادر في عالم فورتنايت.",
                platform: 'epic'
            },
            "fortniteCrew": {
                id: "fortniteCrew",
                title: "Crew Pack",
                price: 270,
                image: "./images/fortnite.png",
                shortDescription: "حزمة طاقم فورتنايت",
                fullDescription: "اشترك في طاقم فورتنايت لتحصل على Battle Pass للموسم الكامل، 1000 V-Bucks كل شهر، وحزمة طاقم حصرية تحتوي على زي وإكسسوارات فريدة لا يمكن الحصول عليها إلا من خلال الاشتراك.",
                platform: 'epic'
            },
            "fortniteStarter": {
                id: "fortniteStarter",
                title: "Starter Pack",
                price: 200,
                image: "./images/starterpack.png",
                shortDescription: "حزمة المبتدئين",
                fullDescription: "أفضل طريقة للبدء في فورتنايت! تحتوي حزمة المبتدئين عادةً على زي حصري و 600 V-Bucks، مما يمنحك قيمة ممتازة بسعر منخفض.",
                platform: 'epic'
            },

        };




        const orders = {
            "74562341": { status: "Shipped", img: "images/my-shipped.png" },
            "12345678": { status: "Delivered", img: "images/my-delivered.png" },
            "87654321": { status: "Processing", img: "images/my-processing.png" },
            "10101010": { status: "Out for Delivery", img: "images/my-outfordelivery.png" }
        };

        const formspreeEndpoints = {
            vodafone: 'https://formspree.io/f/xblaqnzj', //  <-- تم التغيير
            paypal: 'https://formspree.io/f/xblaqnzj',   //  <-- تم التغيير
            feedback: 'https://formspree.io/f/xblaqnzj'  //  <-- تم التغيير
        };

        const discountCodes = {
            "DISCORD10": { percentage: 10 },
            "BERLIN5": { percentage: 5 },
            "GOE": { percentage: 6 }
        };

        let currentProduct = null;
        let cart = JSON.parse(localStorage.getItem('cart')) || {};
        let paymentTimerInterval = null;
        let appliedDiscount = null;
        let animationEventTarget = null; // سيحتفظ بمكان النقرة لتشغيل الأنيميشن

        function initializeFakeRatings() {
            const productIds = Object.keys(productsData);

            productIds.forEach(id => {
                const storageKey = `comments_${id}`;
                if (!localStorage.getItem(storageKey)) {
                    const fakeComments = [];
                    const reviewCount = Math.floor(Math.random() * 10) + 1;

                    for (let i = 0; i < reviewCount; i++) {
                        fakeComments.push({
                            name: `عميل #${i + 1}`,
                            text: "منتج ممتاز وخدمة سريعة!",
                            rating: 5,
                            date: new Date().toISOString(),
                            helpfulCount: 0
                        });
                    }
                    localStorage.setItem(storageKey, JSON.stringify(fakeComments));
                }
            });
        }

        // === الدالة الجديدة والمعدلة لإرسال البيانات إلى جوجل شيت ===
        // === الكود النهائي والمضمون لإرسال الطلب وإظهار الانتظار ===
        // === الكود النهائي والمضمون لإرسال الطلب وإظهار الانتظار ===
        function handlePaymentSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const loadingSection = document.getElementById('loading');
            const loadingText = document.getElementById('loading-text');
            const confirmationSection = document.getElementById('confirmationMessage');

            const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwFNK-1jL6kBFz1BsbPb7lCxKgzVWl2fV2_6ZuPStr1DYhEdsOpQQLIPURI1wFcYQbI_Q/exec";

            // الخطوة 1: إخفاء الفورم فورًا
            form.closest('.modal-content-section').classList.remove('is-visible');

            // الخطوة 2: إظهار شاشة الانتظار وتحديث النص
            loadingText.textContent = "انتظر من فضلك..";
            loadingSection.classList.add('is-visible');
            // **سطر مهم لضمان ظهور شاشة التحميل**
            loadingSection.style.display = 'block';

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            // الخطوة 3: تأخير بسيط قبل إرسال البيانات لضمان عرض شاشة التحميل
            setTimeout(() => {
                fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                })
                    .finally(() => {
                        // بعد انتهاء الإرسال (سواء نجح أو فشل)
                        loadingSection.classList.remove('is-visible');
                        loadingSection.style.display = 'none'; // إخفاءها تمامًا

                        confirmationSection.innerHTML = `<h2>شكرا لشرائك من Berlin Store</h2><p>تم استلام طلبك بنجاح وسنتواصل معك قريبًا.</p>`;
                        confirmationSection.classList.add('is-visible');
                        confirmationSection.style.color = "#00ff00";

                        cart = {}; // تفريغ السلة
                        localStorage.setItem('cart', JSON.stringify(cart));
                        updateCartCount();

                        setTimeout(() => {
                            closeModal('paymentModal');
                        }, 4000);
                    });
            }, 50); // تأخير بسيط جدًا (50 ميلي ثانية) لإعطاء فرصة للمتصفح
        }

        function showToast(message) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast-notification';
            toast.textContent = message;
            container.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('show');
            }, 10);

            setTimeout(() => {
                toast.classList.remove('show');
                toast.addEventListener('transitionend', () => {
                    if (toast.parentElement) {
                        toast.remove();
                    }
                });
            }, 3000);
        }
        function loadOfflineSteamGamesToHome() {
            const container = document.getElementById('offlineSteamContainer');
            container.innerHTML = '';
            const offlineSteamIds = ['mafia', 'residentevil_offline'];
            offlineSteamIds.forEach(id => renderProductItem(productsData[id], container, 'games', true));
        }

        function loadSteamGamesGifting() {
            const container = document.getElementById('steamGamesGiftingContainer');
            container.innerHTML = '';
            const gameGiftIds = ['gta_gift', 'rust_gift', 'seaofthieves_gift', 'rdr2_gift', 'eldenring_gift', 'wallpaperEngine_gift'];
            gameGiftIds.forEach(id => {
                if (productsData[id]) {
                    renderProductItem(productsData[id], container, 'steam_gifting', true);
                }
            });
        }


        document.addEventListener('DOMContentLoaded', () => {
            initializeFakeRatings();

            loadGamesToHome();
            loadSubscriptionsToHome();
            loadOfflineSteamGamesToHome();
            loadSteamGiftCardsToHome();
            loadSteamPointsToHome();
            updateCartCount();
            setupStarRatingInput();
            loadStoreRatings();
            setupStoreRatingInput();
            renderStoreReviews();

            document.getElementById('vodafoneForm').addEventListener('submit', handlePaymentSubmit);
            document.getElementById('paypalForm').addEventListener('submit', handlePaymentSubmit);

            const navbar = document.getElementById('navbar');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 10) {
                    navbar.classList.add('navbar-scrolled');
                } else {
                    navbar.classList.remove('navbar-scrolled');
                }
            });

            handleRouting();
            window.addEventListener('hashchange', handleRouting);
        });

        function setupStarRatingInput() {
            const starsContainer = document.getElementById('ratingStars');
            if (!starsContainer) return;

            const ratingInput = document.getElementById('commentRating');
            const stars = starsContainer.querySelectorAll('.star');

            stars.forEach(star => {
                star.addEventListener('click', () => {
                    const value = star.dataset.value;
                    ratingInput.value = value;
                    starsContainer.dataset.rating = value;
                });
            });
        }
        function addPaymentLogos() {
            const selectElement = document.getElementById('modalPaymentMethod');
            if (selectElement) {
                const options = selectElement.options;
                for (let i = 0; i < options.length; i++) {
                    const option = options[i];
                    if (option.value === 'vodafone') {
                        option.textContent = 'فودافون كاش';
                        const img = document.createElement('img');
                        img.src = './images/vf-cash.png';
                        img.className = 'payment-option-logo';
                        option.prepend(img);
                    } else if (option.value === 'paypal') {
                        option.textContent = 'بايبال';
                        const img = document.createElement('img');
                        img.src = './images/paypal.png';
                        img.className = 'payment-option-logo';
                        option.prepend(img);
                    }
                }
            }
        }

        function handleRouting() {
            const hash = window.location.hash || '#home';
            const [section, param] = hash.substring(1).split('/');

            if (section === 'product' && param && productsData[param]) {
                showProductPage(param);
            } else if (document.getElementById(section)) {
                showSection(section);
                switch (section) {
                    case 'products': loadProducts(); break;
                    case 'subscriptions': loadSubscriptions(); break;
                    case 'valorantPoints': loadValorantPoints(); break;
                    case 'roblox': loadRobux(); break;
                    case 'fortnite': loadFortnite(); break;
                    case 'steamPoints': loadSteamPoints(); break;
                    case 'steamGiftCards': loadSteamGiftCards(); break;
                    case 'steamGamesGifting': loadSteamGamesGifting(); break;
                }
            } else {
                showSection('home');
            }
        }

        /* === START: JavaScript for Navbar Search Bar === */
        function performNavbarSearch() {
            const query = document.getElementById('navbarProductSearch').value;
            if (query.trim() === '') return;
            performGlobalSearch(query);
        }

        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
            window.scrollTo(0, 0);
        }

        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            const overlay = document.getElementById('overlay');
            modal.classList.add('is-visible');
            overlay.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            const modals = document.querySelectorAll('.modal');
            const overlay = document.getElementById('overlay');

            if (modalId === 'all') {
                modals.forEach(m => m.classList.remove('is-visible'));
            } else {
                const modal = document.getElementById(modalId);
                if (modal) modal.classList.remove('is-visible');
            }
            overlay.style.display = 'none';
            document.body.style.overflow = 'auto';

            clearInterval(paymentTimerInterval);

            document.querySelectorAll('.confirm-payment-btn').forEach(btn => btn.disabled = false);

            const paymentModal = document.getElementById('paymentModal');
            if (paymentModal) {
                const allSections = paymentModal.querySelectorAll('.modal-content-section');
                allSections.forEach(section => section.classList.remove('is-visible'));
                document.getElementById('modalCommonContent').classList.add('is-visible');
            }

            if (modalId === 'cartModal' || modalId === 'all') {
                document.getElementById('discountMessage').textContent = '';
                document.getElementById('discountCodeInput').value = '';
                appliedDiscount = null;
            }
        }

        // هذه الدالة الجديدة تحتوي على منطق الإضافة الفعلي
        function performAddToCart(productId, quantity, event, extraData = {}) {
            if (event) {
                flyToCart(event);
            }
            showToast("تمت إضافة المنتج للسلة بنجاح!");

            if (cart[productId]) {
                cart[productId].quantity += quantity;
            } else {
                cart[productId] = {
                    ...productsData[productId],
                    quantity: quantity,
                    ...extraData // هنا نضيف البيانات الإضافية (كود الصديق, الحساب, الخ)
                };
            }
            localStorage.setItem('cart', JSON.stringify(cart));

            setTimeout(() => {
                updateCartCount();
                const cartButton = document.querySelector('.fixed-cart-button');
                cartButton.classList.add('added');
                setTimeout(() => {
                    cartButton.classList.remove('added');
                }, 400);
            }, 500);
        }

        // هذه هي النسخة المحدثة من الدالة الأصلية
function addToCartHandler(event, productId, quantity) {
    const product = productsData[productId];
    const requiresInfo = product.platform === 'riot' ||
                         product.platform === 'roblox' ||
                         product.platform === 'epic' ||
                         product.requiresSteamFriendCode;

    if (requiresInfo) {
        // احفظ مكان النقرة هنا لتشغيله لاحقًا
        animationEventTarget = event.target; 
        openPaymentModal(productId, 'addToCartMode');
    } else {
        performAddToCart(productId, quantity, event);
    }
}

        function flyToCart(event) {
            const cartBtn = document.querySelector('.fixed-cart-button');
            if (!cartBtn || !event) return;

            const productCard = event.target.closest('.product-item, .subscription-item');
            let sourceImageElement;

            if (productCard) {
                sourceImageElement = productCard.querySelector('.product-image-wrapper img, .sub-image-wrapper img');
            } else {
                sourceImageElement = document.getElementById('productPageImage');
            }

            if (!sourceImageElement) return;

            const sourceRect = sourceImageElement.getBoundingClientRect();
            const cartRect = cartBtn.getBoundingClientRect();

            const flyingImg = document.createElement('img');
            flyingImg.src = sourceImageElement.src;
            flyingImg.className = 'product-image-fly';
            document.body.appendChild(flyingImg);

            flyingImg.style.left = `${sourceRect.left}px`;
            flyingImg.style.top = `${sourceRect.top}px`;
            flyingImg.style.width = `${sourceRect.width}px`;
            flyingImg.style.height = `${sourceRect.height}px`;

            requestAnimationFrame(() => {
                flyingImg.style.left = `${cartRect.left + cartRect.width / 2}px`;
                flyingImg.style.top = `${cartRect.top + cartRect.height / 2}px`;
                flyingImg.style.width = '0px';
                flyingImg.style.height = '0px';
                flyingImg.style.opacity = '0.5';
                flyingImg.style.transform = 'rotate(180deg)';
            });

            setTimeout(() => {
                flyingImg.remove();
            }, 800);
        }

        function renderProductItem(product, container, sectionType, showRating) {
            function renderProductItem(product, container, sectionType) {
                // ... (الكود الحالي) ...

                if (product.options && product.isRentable) {
                    //  عرض المنتج بنظام الإيجار
                    const subItem = document.createElement('div');
                    subItem.className = 'subscription-item';
                    subItem.innerHTML = `
                <div class="sub-image-wrapper">
                    <img src="${product.image}" alt="${product.title}">
                </div>
                <div class="sub-content">
                    <h3>${product.title}</h3>
                    <p class="sub-description">${product.shortDescription}</p>
                    <div class="sub-footer">
                        <span class="sub-price">من ${Object.values(product.options)[0].price} ج.م</span>
                        <button onclick="openPaymentModal('${product.id}')" class="subscribe-btn">
                            <span>احجز الآن</span>
                        </button>
                    </div>
                </div>
            `;
                    container.appendChild(subItem);
                    return;
                }

                // ... (الكود الحالي لعرض المنتجات العادية) ...
            }
            if (product.options) {
                const subItem = document.createElement('div');
                subItem.className = 'subscription-item';

                const priceDisplay = `يبدأ من ${product.price} ج.م`;
                const clickHandler = `openPaymentModal('${product.id}')`;

                let ratingHTML = '';
                if (showRating) {
                    const comments = JSON.parse(localStorage.getItem(`comments_${product.id}`)) || [];
                    const ratingCount = comments.length;
                    let starsHTML = '';

                    if (ratingCount > 0) {
                        const averageRating = (comments.reduce((total, comment) => total + (comment.rating || 0), 0) / ratingCount);
                        const roundedRating = Math.round(averageRating);
                        for (let i = 1; i <= 5; i++) {
                            starsHTML += `<span class="star ${i <= roundedRating ? 'filled' : ''}">&#9733;</span>`;
                        }
                    } else {
                        for (let i = 1; i <= 5; i++) {
                            starsHTML += `<span class="star">&#9734;</span>`;
                        }
                    }

                    ratingHTML = `
                                                            <div class="product-card-rating">
                                                                ${starsHTML}
                                                                <span class="rating-count">(${ratingCount})</span>
                                                            </div>`;
                }

                subItem.innerHTML = `
                                                                <div class="sub-image-wrapper" onclick="${clickHandler}">
                                                                    <div class="sub-description-overlay">${product.shortDescription}</div>
                                                                    <img src="${product.image}" alt="${product.title}" loading="lazy" onerror="this.onerror=null;this.src='./images/placeholder.png';">
                                                                </div>
                                                                <div class="sub-content">
                                                                    <h3 onclick="${clickHandler}">${product.title}</h3>
                                                                    ${ratingHTML}
                                                                    <div class="sub-footer">
                                                                        <span class="sub-price">${priceDisplay}</span>
                                                                        <button onclick="${clickHandler}" class="subscribe-btn">
                                                                            <img src="./images/cartt.png" alt="Cart Icon">
                                                                            <span>اشترك الآن</span>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                                `;
                container.appendChild(subItem);
                return;
            }

            const item = document.createElement('div');
            item.className = 'product-item glass-card';

            if (sectionType === 'valorant' || sectionType === 'roblox' || sectionType === 'fortnite') {
                item.classList.add('valorant-item');
            }

            let platformIconHTML = '';
            if (product.platform) {
                let iconSrc = '';
                let altText = '';
                if (product.platform === 'steam') {
                    iconSrc = './images/steam.png';
                    altText = 'Steam';
                } else if (product.platform === 'microsoft') {
                    iconSrc = './images/microsoft.png';
                    altText = 'Microsoft';
                } else if (product.platform === 'riot') {
                    iconSrc = './images/riotgames.png';
                    altText = 'Riot Games';
                } else if (product.platform === 'roblox') {
                    iconSrc = './images/robloxlogo.png';
                    altText = 'Roblox';
                } else if (product.platform === 'epic') {
                    iconSrc = './images/epicgames.png';
                    altText = 'Epic Games';
                }
                if (iconSrc) {
                    platformIconHTML = `<div class="platform-icon"><img src="${iconSrc}" alt="${altText} Icon"></div>`;
                }
            }

            let urgencyHTML = '';
            if (product.stock) {
                urgencyHTML = `<p class="product-urgency">🔥 ${product.stock} قطع فقط متبقية!</p>`;
            }

            let descriptionHTML = product.shortDescription ? `<p class="product-description-text">${product.shortDescription}</p>` : '';
            let priceDisplay = `${product.price} ج.م`;

            let ratingHTML = '';
            if (showRating) {
                const comments = JSON.parse(localStorage.getItem(`comments_${product.id}`)) || [];
                const ratingCount = comments.length;
                let starsHTML = '';

                if (ratingCount > 0) {
                    const averageRating = (comments.reduce((total, comment) => total + (comment.rating || 0), 0) / ratingCount);
                    const roundedRating = Math.round(averageRating);
                    for (let i = 1; i <= 5; i++) {
                        starsHTML += `<span class="star ${i <= roundedRating ? 'filled' : ''}">&#9733;</span>`;
                    }
                } else {
                    for (let i = 1; i <= 5; i++) {
                        starsHTML += `<span class="star">&#9734;</span>`;
                    }
                }

                ratingHTML = `
                                                                    <div class="product-card-rating">
                                                                        ${starsHTML}
                                                                        <span class="rating-count">(${ratingCount})</span>
                                                                    </div>`;
            }


            let clickHandler = `showProductPage('${product.id}')`;

            const altText = product.title;
            const isSteamProduct = product.id.startsWith('steam');

            const buttonsHTML = isSteamProduct ? `
                                                                <div class="product-buttons-container">
                                                                    <button onclick="addToCartHandler(event, '${product.id}', 1)" class="buy-btn" style="width:100%;">أضف للسلة</button>
                                                                </div>
                                                                ` : `
                                                                <div class="product-buttons-container">
                                                                    <button onclick="openPaymentModal('${product.id}')" class="buy-btn">شراء الآن</button>
                                                                    <button onclick="addToCartHandler(event, '${product.id}', 1)" class="add-to-cart-btn">
                                                                        <img src="./images/cartt.png" alt="Add to cart icon">
                                                                    </button>
                                                                </div>
                                                                `;

            const contentWrapper = `
                                                    ${platformIconHTML}
                                                    <div class="product-image-wrapper" onclick="${clickHandler}">
                                                        <img
                                                            src="${product.image}"
                                                            alt="${altText}"
                                                            loading="lazy"
                                                            onerror="this.onerror=null;this.src='./images/placeholder.png';">
                                                    </div>
                                                    <h3 onclick="${clickHandler}">${product.title}</h3>
                                                    ${ratingHTML}
                                                    ${descriptionHTML}
                                                    <p>السعر: ${priceDisplay}</p>
                                                    ${urgencyHTML}
                                                    `;

            const buttonsWrapper = `<div class="product-buttons-wrapper" style="margin-top: auto;">${buttonsHTML}</div>`;

            item.innerHTML = contentWrapper + buttonsWrapper;
            container.appendChild(item);
        }

        // قائمة المنتجات التي ستظهر في كلا القسمين
        const allGamesIds = ['gta', 'minecraft', 'splitfiction', 'mafia', 'rust', 'wallpaperEngine', 'hollowknight', 'seaofthieves', 'rdr2', 'eldenring'];

        function loadGamesToHome() {
            const gamesContainer = document.getElementById('gamesContainer');
            gamesContainer.innerHTML = '';
            // استخدام القائمة الموحدة
            allGamesIds.forEach(id => renderProductItem(productsData[id], gamesContainer, 'games', true));
        }


        function loadRobuxToHome() {
            const robloxContainer = document.getElementById('robloxHomeContainer');
            robloxContainer.innerHTML = '';
            const robloxIds = ['roblox40', 'roblox80', 'roblox400', 'roblox800', 'roblox1700', 'roblox4500'];
            robloxIds.forEach(id => renderProductItem(productsData[id], robloxContainer, 'roblox', true));
        }

        function loadSubscriptionsToHome() {
            const subscriptionsContainer = document.getElementById('homeSubscriptionsContainer');
            subscriptionsContainer.innerHTML = '';
            const subscriptionIds = ['netflix', 'disney', 'crunchyroll', 'gamepass'];
            subscriptionIds.forEach(id => renderProductItem(productsData[id], subscriptionsContainer, 'subscriptions', true));
        }

        function loadSteamPointsToHome() {
            const steamPointsContainer = document.getElementById('steamPointsContainer');
            steamPointsContainer.innerHTML = '';
            const steamPointIds = ['steam20k', 'steam50k'];
            steamPointIds.forEach(id => renderProductItem(productsData[id], steamPointsContainer, 'steam', true));
        }

        function loadSteamGiftCardsToHome() {
            const container = document.getElementById('steamGiftCardsHomeContainer');
            container.innerHTML = '';
            const giftCardIds = ['steamGift5', 'steamGift10', 'steamGift20', 'steamGift50', 'steamGift100'];
            giftCardIds.forEach(id => renderProductItem(productsData[id], container, 'steam', true));
        }

        function loadProducts() {
            const productsContainer = document.getElementById('productsContainer');
            productsContainer.innerHTML = '';
            // استخدام نفس القائمة الموحدة
            allGamesIds.forEach(id => renderProductItem(productsData[id], productsContainer, 'games', false));
        }

        function loadSubscriptions() {
            const subscriptionsContainer = document.getElementById('subscriptionsContainer');
            subscriptionsContainer.innerHTML = '';
            const subscriptionIds = ['netflix', 'disney', 'crunchyroll', 'gamepass'];
            subscriptionIds.forEach(id => renderProductItem(productsData[id], subscriptionsContainer, 'subscriptions', false));
        }

        function loadValorantPoints() {
            const valorantContainer = document.getElementById('valorantPointsPageContainer');
            valorantContainer.innerHTML = '';
            const valorantIds = ['valorant475', 'valorant1000', 'valorant2050', 'valorant3650', 'valorant5350', 'valorant11000'];
            valorantIds.forEach(id => renderProductItem(productsData[id], valorantContainer, 'valorant', true));
        }

        function loadRobux() {
            const robloxContainer = document.getElementById('robloxContainer');
            robloxContainer.innerHTML = '';
            const robloxIds = ['roblox40', 'roblox80', 'roblox400', 'roblox800', 'roblox800_discount', 'roblox1700', 'roblox4700', 'roblox4500'];
            robloxIds.forEach(id => renderProductItem(productsData[id], robloxContainer, 'roblox', true));
        }

        function loadFortnite() {
            const fortniteContainer = document.getElementById('fortniteContainer');
            fortniteContainer.innerHTML = '';
            const fortniteIds = ['fortnite1000', 'fortnite2800', 'fortnite5000', 'fortnite13500', 'fortniteCrew', 'fortniteStarter'];
            fortniteIds.forEach(id => renderProductItem(productsData[id], fortniteContainer, 'fortnite', true));
        }

        function loadSteamPoints() {
            const steamPointsContainer = document.getElementById('steamPointsPageContainer');
            steamPointsContainer.innerHTML = '';
            const steamPointIds = ['steam20k', 'steam50k'];
            steamPointIds.forEach(id => renderProductItem(productsData[id], steamPointsContainer, 'steam', false));
        }

        function loadSteamGiftCards() {
            const steamGiftCardsContainer = document.getElementById('steamGiftCardsPageContainer');
            steamGiftCardsContainer.innerHTML = '';
            const giftCardIds = ['steamGift5', 'steamGift10', 'steamGift20', 'steamGift50', 'steamGift100'];
            giftCardIds.forEach(id => renderProductItem(productsData[id], steamGiftCardsContainer, 'steam', false));
        }

        function searchProducts() {
            const query = document.getElementById('productSearch').value;
            if (query.trim() === '') {
                loadProducts(); // إذا كان البحث فارغًا، أعد عرض كل المنتجات
                return;
            }
            performGlobalSearch(query);
        }

        function checkOrder() {
            const orderCode = document.getElementById('orderCode').value;
            const statusContainer = document.getElementById('statusContainer');
            const resultText = document.getElementById('resultText');
            const statusImage = document.getElementById('statusImage');

            if (orders[orderCode]) {
                const order = orders[orderCode];
                resultText.textContent = `حالة الطلب: ${order.status}`;
                statusImage.src = order.img;
                statusImage.style.display = 'block';
                resultText.style.color = '#00ff00';
            } else {
                resultText.textContent = "عذراً، لم يتم العثور على هذا الطلب.";
                statusImage.style.display = 'none';
                resultText.style.color = 'red';
            }

            resultText.style.opacity = 1;
            statusImage.style.opacity = 1;
        }

        function showProductPage(productId) {
            if (`#product/${productId}` !== window.location.hash) {
                window.location.hash = `product/${productId}`;
                return;
            }

            currentProduct = productsData[productId];

            const imagePlaceholder = document.querySelector('#mainImageContainer .main-image-placeholder');
            const mainImage = document.getElementById('productPageImage');
            imagePlaceholder.style.display = 'flex';
            mainImage.style.display = 'none';

            document.getElementById('productPageTitle').textContent = currentProduct.title;
            document.getElementById('productPagePrice').textContent = `${currentProduct.price} ج.م`;
            document.getElementById('productPageShortDescription').textContent = currentProduct.shortDescription || '';

            document.getElementById('productPageFullDescription').innerHTML = `<h2>  الوصف:  </h2>${currentProduct.fullDescription || ''}`;
            document.getElementById('specs').innerHTML = currentProduct.specs || '<p>لا توجد مواصفات متاحة حاليًا لهذا المنتج.</p>';

            mainImage.onload = () => {
                imagePlaceholder.style.display = 'none';
                mainImage.style.display = 'block';
            };
            mainImage.src = currentProduct.image;

            const platformContainer = document.getElementById('productPagePlatform');
            platformContainer.innerHTML = '';
            if (currentProduct.platform) {
                let platformName = '';
                let platformIconSrc = '';
                if (currentProduct.platform === 'steam') {
                    platformName = 'Steam';
                    platformIconSrc = './images/steam.png';
                } else if (currentProduct.platform === 'microsoft') {
                    platformName = 'Microsoft';
                    platformIconSrc = './images/microsoft.png';
                } else if (currentProduct.platform === 'riot') {
                    platformName = 'Riot Games';
                    platformIconSrc = './images/riotgames.png';
                } else if (currentProduct.platform === 'roblox') {
                    platformName = 'Roblox';
                    platformIconSrc = './images/robloxlogo.png';
                } else if (currentProduct.platform === 'epic') {
                    platformName = 'Epic Games';
                    platformIconSrc = './images/epicgames.png';
                }

if (platformName) {
    platformHTML = `
        <div class="platform-display" style="display: flex; justify-content: flex-end; align-items: center; width: 100%; gap: 8px;">
            <span>المنصة:</span>
            <strong>${platformName}</strong>
            <img src="${platformIconSrc}" alt="${platformName} Logo">
        </div>
    `;
}
            }


            const badgeElement = document.getElementById('productPageBadge');
            badgeElement.innerHTML = '';
            if (currentProduct.badges && currentProduct.badges.length > 0) {
                const badge = currentProduct.badges[0];
                const badgeClass = badge.toLowerCase().includes('bestseller') ? 'bestseller' : 'special';
                badgeElement.className = `product-detail-badge ${badgeClass}`;
                badgeElement.textContent = badge;
            }

            const quantityInput = document.getElementById('productPageQuantity');
            quantityInput.value = 1;
            document.getElementById('decreaseProductPageQuantity').onclick = () => {
                if (quantityInput.value > 1) quantityInput.value--;
            };
            document.getElementById('increaseProductPageQuantity').onclick = () => {
                quantityInput.value++;
            };

            document.getElementById('addToCartBtn').onclick = (event) => {
                const quantity = parseInt(quantityInput.value);
                addToCartHandler(event, currentProduct.id, quantity);
            };

            setupTabs();

            loadComments(productId);
            updateProductPageAverageRating(productId);
            showSection('productPage');
        }

        function setupTabs() {
            const tabContainers = document.querySelectorAll('.tabs-container');
            tabContainers.forEach(container => {
                const tabButtons = container.querySelectorAll('.tab-button');
                const tabContents = container.querySelectorAll('.tab-content');

                tabButtons.forEach(button => {
                    button.onclick = () => {
                        tabButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');

                        const targetTabId = button.dataset.tab;
                        tabContents.forEach(content => {
                            if (content.id === targetTabId) {
                                content.classList.add('active');
                            } else {
                                content.classList.remove('active');
                            }
                        });
                    };
                });
            });
        }

        function updateSteamProductTotal() {
            if (!currentProduct || !currentProduct.id.startsWith('steam')) {
                return;
            }

            const quantityInput = document.getElementById('quantityInput');
            let quantity = parseInt(quantityInput.value);

            if (isNaN(quantity) || quantity < 1) {
                quantity = 1;
                quantityInput.value = 1;
            }

            const basePrice = currentProduct.price;
            const totalPrice = basePrice * quantity;

            document.getElementById('totalPriceDisplay').textContent = totalPrice;

            const finalTitle = `${currentProduct.title} (x${quantity})`;
            document.getElementById('vodafone_product_price').value = totalPrice;
            document.getElementById('paypal_product_price').value = totalPrice;
            document.getElementById('vodafone_product_name').value = finalTitle;
            document.getElementById('paypal_product_name').value = finalTitle;
        }

        function openPaymentModal(productId, mode = 'buyNow') {
            currentProduct = productsData[productId];
            const modal = document.getElementById('paymentModal');

            const modalImageElement = document.getElementById('modalImage');
            modalImageElement.src = currentProduct.image;
            modalImageElement.classList.add('product-modal-image');
            document.getElementById('modalTitle').textContent = currentProduct.title;

            // START: التعديل المطلوب
            // هنا سنقوم بتجهيز وعرض معلومات المنصة والوصف القصير
            const infoContainer = document.getElementById('modalProductInfo');
            infoContainer.innerHTML = ''; // تفريغ الحاوية أولاً

            let platformHTML = '';
            if (currentProduct.platform) {
                let platformName = '';
                let platformIconSrc = '';
                if (currentProduct.platform === 'steam') {
                    platformName = 'Steam';
                    platformIconSrc = './images/steam.png';
                } else if (currentProduct.platform === 'microsoft') {
                    platformName = 'Microsoft';
                    platformIconSrc = './images/microsoft.png';
                } else if (currentProduct.platform === 'riot') {
                    platformName = 'Riot Games';
                    platformIconSrc = './images/riotgames.png';
                } else if (currentProduct.platform === 'roblox') {
                    platformName = 'Roblox';
                    platformIconSrc = './images/robloxlogo.png';
                } else if (currentProduct.platform === 'epic') {
                    platformName = 'Epic Games';
                    platformIconSrc = './images/epicgames.png';
                }

                if (platformName) {
                    // هذا السطر يضمن أن كل شيء بالداخل (الاسم والأيقونة) يكون في المنتصف
                    platformHTML = `
        <div class="platform-display" style="display: flex; justify-content: center; align-items: center; width: 100%; gap: 8px;">
            <span>المنصة:</span>
            <strong>${platformName}</strong>
            <img src="${platformIconSrc}" alt="${platformName} Logo">
        </div>
    `;
                }
            }

            const descriptionHTML = currentProduct.fullDescription ? `<div class="description-display">${currentProduct.fullDescription}</div>` : '';

            // إضافة كود المنصة والوصف إلى الحاوية المخصصة
            infoContainer.innerHTML = platformHTML + descriptionHTML;
            // END: التعديل المطلوب

            const accountDetailsContainer = document.getElementById('account-details-container');
            const riotIdGroup = document.getElementById('riot-id-group');
            const steamFriendCodeGroup = document.getElementById('steam-friend-code-group');
            const subscriptionGroup = document.getElementById('subscription-group');
            const priceDisplayElement = document.getElementById('modalPrice');
            const quantitySelector = document.getElementById('steamProductQuantitySelector');
            const actionButton = document.getElementById('modal-action-button');

            // --- إعادة تعيين كل الحقول ---
            accountDetailsContainer.style.display = 'none';
            riotIdGroup.style.display = 'none';
            steamFriendCodeGroup.style.display = 'none';
            subscriptionGroup.style.display = 'none';
            quantitySelector.style.display = 'none';
            priceDisplayElement.style.display = 'block';

            document.getElementById('riot_id_input').required = false;
            document.getElementById('steam_friend_code_input').required = false;
            document.getElementById('account_email').required = false;
            document.getElementById('account_password').required = false;
            document.getElementById('account_contact').required = false;

            // --- عرض الحقول بناءً على نوع المنتج ---
            if (currentProduct.requiresSteamFriendCode) {
                steamFriendCodeGroup.style.display = 'block';
                document.getElementById('steam_friend_code_input').required = true;
                priceDisplayElement.textContent = `السعر: ${currentProduct.price} ج.م`;
            } else if (currentProduct.platform === 'riot') {
                riotIdGroup.style.display = 'block';
                document.getElementById('riot_id_input').required = true;
                priceDisplayElement.textContent = `السعر: ${currentProduct.price} ج.م`;
            } else if (currentProduct.platform === 'roblox' || currentProduct.platform === 'epic') {
                accountDetailsContainer.style.display = 'flex';
                document.getElementById('account_email').required = true;
                document.getElementById('account_password').required = true;
                document.getElementById('account_contact').required = true;
                priceDisplayElement.textContent = `السعر: ${currentProduct.price} ج.م`;
            } else if (currentProduct.options) {
                subscriptionGroup.style.display = 'block';
                const optionsContainer = document.getElementById('subscription-options-container');
                optionsContainer.innerHTML = '';
                let isFirstOption = true;

                for (const key in currentProduct.options) {
                    const optionData = currentProduct.options[key];
                    const optionLabel = document.createElement('label');
                    optionLabel.className = 'subscription-option-label';

                    const checkedAttribute = isFirstOption ? 'checked' : '';

                    optionLabel.innerHTML = `
                <input type="radio" name="subscriptionPeriod" value="${key}" ${checkedAttribute} onchange="updateModalPriceForSubscription()">
                <div class="subscription-option-card">
                    <span class="period">${optionData.title}</span>
                    <span class="price">${optionData.price} ج.م</span>
                </div>
            `;
                    optionsContainer.appendChild(optionLabel);
                    isFirstOption = false;
                }
                updateModalPriceForSubscription();
                priceDisplayElement.style.display = 'none';
            } else {
                priceDisplayElement.textContent = `السعر: ${currentProduct.price} ج.م`;
            }

            if (mode === 'addToCartMode') {
                actionButton.textContent = 'تأكيد وإضافة للسلة';
                actionButton.onclick = () => handleAddToCartFromModal();
            } else {
                actionButton.textContent = 'اذهب للدفع';
                actionButton.onclick = goToPaymentDetails;
            }

            showModal('paymentModal');
        }

        // أضف هذه الدالة الجديدة بالكامل مع باقي الدوال
        function handleAddToCartFromModal() {
            const extraData = {};
            let isValid = true;

            if (currentProduct.requiresSteamFriendCode) {
                const friendCode = document.getElementById('steam_friend_code_input').value;
                if (!friendCode) {
                    alert('الرجاء إدخال كود الصداقة.');
                    isValid = false;
                } else {
                    extraData.steam_friend_code = friendCode;
                }
            } else if (currentProduct.platform === 'riot') {
                const riotId = document.getElementById('riot_id_input').value;
                if (!riotId || !riotId.includes('#')) {
                    alert('الرجاء إدخال Riot ID صحيح.');
                    isValid = false;
                } else {
                    extraData.riot_id = riotId;
                }
            } else if (currentProduct.platform === 'roblox' || currentProduct.platform === 'epic') {
                const email = document.getElementById('account_email').value;
                const password = document.getElementById('account_password').value;
                if (!email || !password) {
                    alert('الرجاء إدخال بيانات الحساب.');
                    isValid = false;
                } else {
                    extraData.account_email = email;
                }
            }

            if (isValid) {
                performAddToCart(currentProduct.id, 1, null, extraData);
                closeModal('paymentModal');
            }
        }

        function updateModalPriceForSubscription() {
            // البحث عن الزر المختار
            const selectedRadio = document.querySelector('input[name="subscriptionPeriod"]:checked');
            if (!selectedRadio) return; // الخروج إذا لم يتم اختيار شيء

            const period = selectedRadio.value;
            const selectedOption = currentProduct.options[period];
            const price = selectedOption.price;
            const title = `${currentProduct.title} (${selectedOption.title})`;

            // تحديث السعر في كل الأماكن المطلوبة
            document.getElementById('modalPrice').textContent = `السعر: ${price} ج.م`;
            document.getElementById('vodafone_product_price').value = price;
            document.getElementById('paypal_product_price').value = price;
            document.getElementById('vodafone_product_name').value = title;
            document.getElementById('paypal_product_name').value = title;
        }

        function startPaymentTimer(duration, display, form) {
            clearInterval(paymentTimerInterval);
            let timer = duration;
            const submitButton = form.querySelector('button[type="submit"]');

            paymentTimerInterval = setInterval(function () {
                let minutes = parseInt(timer / 60, 10);
                let seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                display.textContent = minutes + ":" + seconds;
                display.classList.remove('expired');

                if (--timer < 0) {
                    clearInterval(paymentTimerInterval);
                    display.textContent = "انتهت المهلة";
                    display.classList.add('expired');
                    if (submitButton) submitButton.disabled = true;
                }
            }, 1000);
        }

        function goToPaymentDetails() {
            // --- جمع البيانات من النافذة المنبثقة ---
            let finalPrice;
            let finalTitle;
            const extraData = {};

            // التحقق إذا كان المنتج اشتراكاً
            if (currentProduct.options) {
                const selectedRadio = document.querySelector('input[name="subscriptionPeriod"]:checked');
                const period = selectedRadio.value;
                const selectedOption = currentProduct.options[period];
                finalPrice = selectedOption.price;
                finalTitle = `${currentProduct.title} (${selectedOption.title})`;
            } else {
                finalPrice = currentProduct.price;
                finalTitle = currentProduct.title;
            }

            // جمع البيانات الإضافية (مثل Riot ID)
            if (currentProduct.requiresSteamFriendCode) {
                const friendCodeInput = document.getElementById('steam_friend_code_input');
                if (!friendCodeInput.value) {
                    alert('الرجاء إدخال Steam Friend Code الخاص بك.');
                    return;
                }
                extraData['Steam Friend Code'] = friendCodeInput.value;
            } else if (currentProduct.platform === 'riot') {
                const riotIdInput = document.getElementById('riot_id_input');
                if (!riotIdInput.value || !riotIdInput.value.includes('#')) {
                    alert('الرجاء إدخال Riot ID صحيح بالشكل التالي: Name#TAG');
                    return;
                }
                extraData['Riot ID'] = riotIdInput.value;
            } else if (currentProduct.platform === 'roblox' || currentProduct.platform === 'epic') {
                const accountEmail = document.getElementById('account_email').value;
                const accountPassword = document.getElementById('account_password').value;
                const accountContact = document.getElementById('account_contact').value;
                if (!accountEmail || !accountPassword || !accountContact) {
                    alert('الرجاء إدخال جميع بيانات الحساب المطلوبة.');
                    return;
                }
                extraData['Account Email'] = accountEmail;
                extraData['Account Password'] = accountPassword;
                extraData['Contact Method'] = accountContact;
            }

            const method = document.getElementById('modalPaymentMethod').value;

            // استدعاء دالة الدفع الموحدة مع بيانات المنتج الواحد
            showPaymentDetails(method, finalPrice, finalTitle, extraData);
        }

        function generateStarsHTML(rating) {
            let starsHTML = '';
            for (let i = 1; i <= 5; i++) {
                const starClass = i <= rating ? 'star filled' : 'star';
                starsHTML += `<span class="${starClass}">&#9733;</span>`;
            }
            return `<div class="comment-rating">${starsHTML}</div>`;
        }

        function markHelpful(event, productId, commentIndex) {
            const comments = JSON.parse(localStorage.getItem(`comments_${productId}`)) || [];
            if (comments[commentIndex]) {
                if (!comments[commentIndex].helpfulCount) {
                    comments[commentIndex].helpfulCount = 0;
                }
                comments[commentIndex].helpfulCount++;
                localStorage.setItem(`comments_${productId}`, JSON.stringify(comments));

                const button = event.target;
                const countSpan = button.nextElementSibling;
                countSpan.textContent = `(${comments[commentIndex].helpfulCount})`;
                button.disabled = true;
            }
        }

        function loadComments(productId) {
            const commentsContainer = document.getElementById('commentList');
            const loadMoreBtn = document.getElementById('loadMoreComments');

            allComments = JSON.parse(localStorage.getItem(`comments_${productId}`)) || [];
            allComments.sort((a, b) => new Date(b.date) - new Date(a.date));

            commentsContainer.innerHTML = '';
            commentsLoaded = 0;

            if (allComments.length === 0) {
                commentsContainer.innerHTML = `<p style="text-align: center; color: #ccc;">لا توجد تعليقات حتى الآن. كن أول من يعلق!</p>`;
                loadMoreBtn.style.display = 'none';
            } else {
                renderMoreComments();
                if (allComments.length > commentsPerPage) {
                    loadMoreBtn.style.display = 'block';
                } else {
                    loadMoreBtn.style.display = 'none';
                }
            }

            loadMoreBtn.onclick = renderMoreComments;
        }

        function renderMoreComments() {
            const commentsContainer = document.getElementById('commentList');
            const loadMoreBtn = document.getElementById('loadMoreComments');
            const startIndex = commentsLoaded;
            const commentsToLoad = allComments.slice(startIndex, startIndex + commentsPerPage);

            commentsToLoad.forEach((comment, index) => {
                const absoluteIndex = startIndex + index;
                const commentItem = document.createElement('div');
                commentItem.className = 'comment-card';

                const starsHTML = generateStarsHTML(comment.rating || 0);
                const helpfulCount = comment.helpfulCount || 0;

                commentItem.innerHTML = `
                                                    <div class="comment-card-header">
                                                        <span class="comment-author">${comment.name}</span>
                                                        ${starsHTML}
                                                    </div>
                                                    <p class="comment-text">${comment.text}</p>
                                                    <div class="comment-footer">
                                                        <span>هل كان هذا التقييم مفيداً؟</span>
                                                        <button class="helpful-btn" onclick="markHelpful(event, '${currentProduct.id}', ${absoluteIndex})">نعم</button>
                                                        <span>(${helpfulCount})</span>
                                                    </div>`;
                commentsContainer.appendChild(commentItem);
            });

            commentsLoaded += commentsToLoad.length;
            if (commentsLoaded >= allComments.length) {
                loadMoreBtn.style.display = 'none';
            }
        }

        function submitComment(event) {
            event.preventDefault();
            const name = document.getElementById('commentName').value;
            const text = document.getElementById('commentText').value;
            const rating = document.getElementById('commentRating').value;
            const productId = currentProduct.id;

            if (!name) {
                alert('الرجاء إدخال اسمك.');
                return;
            }
            if (parseInt(rating) === 0) {
                alert('الرجاء إضافة تقييم للمنتج.');
                return;
            }

            const newComment = {
                name,
                text: text || " ",
                rating: parseInt(rating),
                date: new Date().toISOString(),
                helpfulCount: 0
            };
            const comments = JSON.parse(localStorage.getItem(`comments_${productId}`)) || [];
            comments.unshift(newComment);
            localStorage.setItem(`comments_${productId}`, JSON.stringify(comments));

            document.getElementById('commentName').value = '';
            document.getElementById('commentText').value = '';
            document.getElementById('commentRating').value = '0';
            document.getElementById('ratingStars').dataset.rating = '0';

            loadComments(productId);
            updateProductPageAverageRating(productId);
        }


        function updateProductPageAverageRating(productId) {
            const ratingContainer = document.getElementById('productPageAverageRating');
            if (!ratingContainer) return;

            const comments = JSON.parse(localStorage.getItem(`comments_${productId}`)) || [];

            if (comments.length === 0) {
                ratingContainer.innerHTML = `<span class="rating-summary">لا توجد تقييمات بعد.</span>`;
                return;
            }

            const totalRating = comments.reduce((sum, comment) => sum + (comment.rating || 0), 0);
            const averageRating = totalRating / comments.length;
            const roundedAverage = Math.round(averageRating);

            let starsHTML = '';
            for (let i = 1; i <= 5; i++) {
                const starClass = i <= roundedAverage ? 'star' : 'star empty';
                starsHTML += `<span class="${starClass}">&#9733;</span>`;
            }

            ratingContainer.innerHTML = `
                                                                    <div class="stars">${starsHTML}</div>
                                                                    <span class="rating-summary">${averageRating.toFixed(1)} من 5 (${comments.length} تقييم)</span>
                                                                    `;
        }

        function updateCartCount() {
            const totalItems = Object.values(cart).reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cart-count').textContent = totalItems;
        }

        function applyDiscount() {
            const code = document.getElementById('discountCodeInput').value.toUpperCase();
            const messageEl = document.getElementById('discountMessage');

            if (discountCodes[code]) {
                appliedDiscount = {
                    code: code,
                    percentage: discountCodes[code].percentage
                };
                messageEl.textContent = `تم تطبيق خصم ${appliedDiscount.percentage}% بنجاح!`;
                messageEl.className = 'discount-message success';
            } else {
                appliedDiscount = null;
                messageEl.textContent = 'كود الخصم غير صالح أو منتهي الصلاحية.';
                messageEl.className = 'discount-message error';
            }
            renderCart();
        }

function renderCart() {
            const cartItemsContainer = document.getElementById('cartItemsContainer');
            const cartTotalContainer = document.getElementById('cartTotalContainer');
            cartItemsContainer.innerHTML = '';
            let total = 0;

            if (Object.keys(cart).length === 0) {
                cartItemsContainer.innerHTML = `<p style="text-align: center; color: #ccc;">سلتك فارغة.</p>`;
            } else {
                for (const productId in cart) {
                    const item = cart[productId];
                    let itemPrice = item.price; // استخدم السعر الأساسي كافتراضي

                    // تحقق إذا كان المنتج اشتراكًا وله خيار محدد
                    if (item.options && item.selectedOption) {
                        itemPrice = item.selectedOption.price;
                    }

                    let extraInfoHTML = '';
                    if (item.riot_id) {
                        extraInfoHTML = `<div class="cart-item-extra-info">ID: ${item.riot_id}</div>`;
                    } else if (item.steam_friend_code) {
                        extraInfoHTML = `<div class="cart-item-extra-info">Friend Code: ${item.steam_friend_code}</div>`;
                    } else if (item.account_email) {
                        extraInfoHTML = `<div class="cart-item-extra-info">Account: ${item.account_email}</div>`;
                    } else if (item.selectedOption) {
                        extraInfoHTML = `<div class="cart-item-extra-info">المدة: ${item.selectedOption.title}</div>`;
                    }

                    const itemElement = document.createElement('div');
                    itemElement.className = 'cart-modal-item';
                    itemElement.innerHTML = `
                        <img src="${item.image}" alt="${item.title}">
                        <div class="item-details">
                            <h4>${item.title}</h4>
                            <p>${itemPrice} ج.م</p>
                            ${extraInfoHTML}
                        </div>
                        <div class="quantity-controls">
                            <button onclick="changeQuantity('${productId}', -1)">-</button>
                            <span>${item.quantity}</span>
                            <button onclick="changeQuantity('${productId}', 1)">+</button>
                        </div>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                    total += itemPrice * item.quantity;
                }
            }

            // === هذا هو الجزء الذي كان ناقصًا ===
            const originalTotal = total;
            let finalTotal = total;

            if (appliedDiscount) {
                const discountAmount = finalTotal * (appliedDiscount.percentage / 100);
                finalTotal -= discountAmount;
            }

            if (appliedDiscount) {
                cartTotalContainer.innerHTML = `
                    الإجمالي: <span class="original-price">${originalTotal.toFixed(2)} ج.م</span>
                    <span id="cartTotalPrice">${finalTotal.toFixed(2)}</span> ج.م
                `;
            } else {
                cartTotalContainer.innerHTML = `الإجمالي: <span id="cartTotalPrice">${finalTotal.toFixed(2)}</span> ج.م`;
            }
            // === نهاية الجزء الناقص ===
        }

        function changeQuantity(productId, change) {
            if (cart[productId]) {
                cart[productId].quantity += change;
                if (cart[productId].quantity <= 0) {
                    delete cart[productId];
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                renderCart();
            }
        }

        function removeFromCart(productId) {
            if (cart[productId]) {
                delete cart[productId];
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                renderCart();
            }
        }

        function goToCheckout() {
            if (Object.keys(cart).length === 0) {
                alert('سلة التسوق فارغة!');
                return;
            }
            closeModal('cartModal');
            showModal('checkoutModal');
            renderCheckoutPaymentOptions();
        }

        function renderCheckoutPaymentOptions() {
            const container = document.getElementById('checkoutPaymentOptionsContainer');
            container.innerHTML = '';

            let total = Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0);

            if (appliedDiscount) {
                const discountAmount = total * (appliedDiscount.percentage / 100);
                total = total - discountAmount;
            }

            const vodafoneCard = document.createElement('div');
            vodafoneCard.className = 'payment-method-card';
            vodafoneCard.onclick = () => showPaymentDetails('vodafone', total);
            vodafoneCard.innerHTML = `
                                                                            <h3>
                                                                                <img src="./images/vf-cash.png" alt="Vodafone Cash Logo">
                                                                                فودافون كاش
                                                                            </h3>
                                                                            <p>الدفع عبر محفظة فودافون كاش</p>
                                                                            `;
            container.appendChild(vodafoneCard);

            const paypalCard = document.createElement('div');
            paypalCard.className = 'payment-method-card';
            paypalCard.onclick = () => showPaymentDetails('paypal', total);
            paypalCard.innerHTML = `
                                                                            <h3>
                                                                                <img src="./images/paypal.png" alt="PayPal Logo">
                                                                                بايبال
                                                                            </h3>
                                                                            <p>الدفع عبر حساب بايبال</p>
                                                                            `;
            container.appendChild(paypalCard);
        }

        function showPaymentDetails(method, total, singleProductTitle = null, singleProductExtraData = {}) {
            closeModal('checkoutModal');
            closeModal('paymentModal'); // إغلاق أي نوافذ أخرى أولاً
            showModal('paymentModal');

            const allSections = document.getElementById('paymentModal').querySelectorAll('.modal-content-section');
            allSections.forEach(section => section.classList.remove('is-visible'));

            const detailsSection = document.getElementById(`${method}Details`);
            if (detailsSection) {
                detailsSection.classList.add('is-visible');
                const form = detailsSection.querySelector('form');

                // مسح الحقول المخفية القديمة
                const hiddenFields = form.querySelectorAll('input[type="hidden"]');
                hiddenFields.forEach(field => {
                    if (field.name !== 'payment_method') { // لا تمسح طريقة الدفع
                        field.value = '';
                    }
                });

                let productSummary;

                // تحديد مصدر البيانات: إما منتج واحد أو السلة
                if (singleProductTitle) {
                    // الحالة الأولى: شراء فوري لمنتج واحد
                    productSummary = singleProductTitle;
                    // إضافة البيانات الإضافية للحقول المخفية
                    for (const key in singleProductExtraData) {
                        const input = form.querySelector(`input[name="${key}"]`);
                        if (input) {
                            input.value = singleProductExtraData[key];
                        }
                    }
                } else {
                    // الحالة الثانية: إتمام الشراء من السلة
                    productSummary = Object.values(cart).map(item => {
                        let title = item.title;
                        // لو المنتج في السلة اشتراك، أضف المدة المختارة
                        if (item.selectedOption) {
                            title = `${item.title} (${item.selectedOption.title})`;
                        }
                        return `${title} (x${item.quantity})`;
                    }).join(' | ');
                }

                form.querySelector('input[name="product"]').value = productSummary;
                form.querySelector('input[name="price"]').value = total.toFixed(2);

                const totalAmountText = `${total.toFixed(2)} ج.م`;
                const timerDisplay = detailsSection.querySelector('.payment-timer-value');
                const totalAmountSpan = detailsSection.querySelector('.payment-total-amount-value');

                totalAmountSpan.textContent = totalAmountText;
                form.querySelector('button[type="submit"]').disabled = false;
                startPaymentTimer(3600, timerDisplay, form);
            }
        }

        function submitFeedback() {
            const name = document.getElementById('feedback-name').value;
            const feedbackText = document.getElementById('feedback-text').value;
            const messageElement = document.getElementById('feedback-message');

            if (!feedbackText.trim()) {
                messageElement.textContent = "من فضلك اكتب ملاحظاتك قبل الإرسال.";
                messageElement.style.color = 'red';
                return;
            }

            const formData = new FormData();
            formData.append('name', name || 'غير محدد');
            formData.append('feedback', feedbackText);

            fetch(formspreeEndpoints.feedback, {
                method: 'POST',
                body: formData,
                headers: { 'Accept': 'application/json' }
            })
                .then(response => {
                    if (response.ok) {
                        messageElement.textContent = "شكراً لمشاركتك! تم إرسال ملاحظاتك بنجاح.";
                        messageElement.style.color = '#00ff00';
                        document.getElementById('feedback-name').value = '';
                        document.getElementById('feedback-text').value = '';
                    } else {
                        response.json().then(data => {
                            messageElement.textContent = data.errors ? data.errors.map(error => error.message).join(", ") : "حدث خطأ ما. يرجى المحاولة مرة أخرى.";
                        });
                        messageElement.style.color = 'red';
                    }
                })
                .catch(() => {
                    messageElement.textContent = "حدث خطأ في الاتصال. يرجى التحقق من اتصالك بالإنترنت.";
                    messageElement.style.color = 'red';
                });
        }
    </script>
</body>
</html>